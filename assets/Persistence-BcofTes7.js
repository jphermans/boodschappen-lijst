import{r as e,j as s,p as t,k as a,d as r,b as l,D as i,J as n,a as c,e as o}from"./vendor-CjuAVZ7F.js";import{b as d,c as m}from"./index-DN0dzhwU.js";import{firebaseBackup as x}from"./firebaseBackup-DNKn96ET.js";import{m as g}from"./ui-CiILanuQ.js";import"./firebase-DuvuO4R-.js";const h=({onBack:h})=>{const{healthInfo:b,refreshHealthInfo:p,isLoading:u}=d(),{isCreatingBackup:j,isRestoring:f,error:N}=m(),[y,v]=e.useState(!1),[w,k]=e.useState(!1),[B,S]=e.useState(null),H=e=>e?new Date(e).toLocaleString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Nooit";return u?s.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-4xl mx-auto px-4 lg:px-8 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})}):s.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-4xl mx-auto px-4 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex items-center mb-8",children:[s.jsxs("button",{onClick:h,className:"flex items-center space-x-2 px-4 py-2 bg-[rgb(var(--card-bg))] rounded-lg hover:bg-[rgb(var(--border-color))]/20 transition-colors",children:[s.jsx(t,{className:"w-5 h-5"}),s.jsx("span",{children:"Terug"})]}),s.jsxs("div",{className:"flex-1 text-center",children:[s.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-[rgb(var(--card-text))]",children:"Persistentie Status"}),s.jsx("p",{className:"text-[rgb(var(--text-color))]/60 mt-2",children:"Beheer en controleer je opgeslagen gegevens"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-[rgb(var(--card-bg))] rounded-xl shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Opslag Status"}),(e=>{switch(e){case"healthy":return s.jsx(o,{className:"w-5 h-5 text-green-500"});case"warning":return s.jsx(c,{className:"w-5 h-5 text-yellow-500"});case"error":return s.jsx(c,{className:"w-5 h-5 text-red-500"});default:return s.jsx(r,{className:"w-5 h-5 text-gray-500"})}})(b?.storageHealth?.status)]}),s.jsx("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${(e=>{switch(e){case"healthy":return"bg-green-100 text-green-800 border-green-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"error":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(b?.storageHealth?.status)}`,children:b?.storageHealth?.status||"Onbekend"}),s.jsxs("p",{className:"text-sm text-[rgb(var(--text-color))]/60 mt-2",children:["Laatste check: ",H(b?.storageHealth?.lastCheck)]})]}),s.jsxs("div",{className:"bg-[rgb(var(--card-bg))] rounded-xl shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Gegevensgrootte"}),s.jsx(a,{className:"w-5 h-5 text-primary"})]}),s.jsx("p",{className:"text-2xl font-bold text-[rgb(var(--card-text))]",children:(e=>{if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]})(b?.storageHealth?.totalSize||0)}),s.jsxs("p",{className:"text-sm text-[rgb(var(--text-color))]/60",children:[b?.storageHealth?.items||0," items opgeslagen"]})]}),s.jsxs("div",{className:"bg-[rgb(var(--card-bg))] rounded-xl shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Laatste Sync"}),s.jsx(r,{className:"w-5 h-5 text-secondary"})]}),s.jsx("p",{className:"text-sm font-medium text-[rgb(var(--card-text))]",children:H(b?.lastSyncTime)}),s.jsxs("p",{className:"text-sm text-[rgb(var(--text-color))]/60",children:[b?.syncQueue||0," items in wachtrij"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-[rgb(var(--card-bg))] rounded-xl shadow-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Opslag Details"}),s.jsx("div",{className:"space-y-3",children:b?.state&&Object.entries(b.state).map(([e,t])=>s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-[rgb(var(--border-color))]/20",children:[s.jsx("span",{className:"text-sm font-medium capitalize",children:e}),s.jsx("span",{className:"text-sm text-[rgb(var(--text-color))]/60",children:Array.isArray(t)?`${t.length} items`:"object"==typeof t?`${Object.keys(t).length} properties`:String(t)})]},e))})]}),s.jsxs("div",{className:"bg-[rgb(var(--card-bg))] rounded-xl shadow-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Acties"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:p,disabled:u,className:"w-full flex items-center justify-center px-4 py-3 bg-[rgb(var(--color-primary-button))] hover:opacity-90 text-white rounded-lg transition-colors disabled:opacity-50",children:[s.jsx(l,{className:"w-4 h-4 mr-2"}),"Vernieuwen"]}),s.jsxs("button",{onClick:async()=>{try{v(!0),await x.createDownloadableBackup()}catch(e){alert(`‚ùå Backup maken mislukt: ${e.message||"Onbekende fout"}`)}finally{v(!1)}},disabled:y||j,className:"w-full flex items-center justify-center px-4 py-3 bg-[rgb(var(--color-secondary-button))] hover:opacity-90 text-white rounded-lg transition-colors disabled:opacity-50",children:[s.jsx(i,{className:"w-4 h-4 mr-2"}),y||j?"Backup maken...":"Firebase Backup"]}),s.jsxs("label",{className:"w-full flex items-center justify-center px-4 py-3 bg-[rgb(var(--color-info-button))] hover:opacity-90 text-white rounded-lg transition-colors cursor-pointer",children:[s.jsx(n,{className:"w-4 h-4 mr-2"}),w||f?"Herstellen...":"Firebase Herstellen",s.jsx("input",{type:"file",accept:".json",onChange:async e=>{const s=e.target.files[0];if(s)try{k(!0);const e=await x.restoreFromFile(s,{importOwnLists:!0,importSharedLists:!1,skipDuplicates:!0});e.success?(alert(`‚úÖ Backup hersteld! ${e.imported} lijst(en) ge√Ømporteerd, ${e.skipped} overgeslagen. Vernieuw de pagina om de wijzigingen te zien.`),setTimeout(()=>{window.location.reload()},2e3)):alert("‚ùå Herstellen mislukt. Controleer het bestand en probeer opnieuw.")}catch(t){alert(`‚ùå Fout bij herstellen: ${t.message||"Onbekende fout"}`)}finally{k(!1),e.target.value=""}},className:"hidden",disabled:w||f})]})]}),s.jsxs("div",{className:"mt-4 p-4 bg-[rgb(var(--border-color))]/10 rounded-lg",children:[s.jsx("h4",{className:"font-medium mb-2",children:"üí° Wat wordt gebackupt?"}),s.jsxs("ul",{className:"text-sm text-[rgb(var(--text-color))]/60 space-y-1",children:[s.jsx("li",{children:"‚Ä¢ ‚úÖ Alle boodschappenlijsten (inclusief items)"}),s.jsx("li",{children:"‚Ä¢ ‚úÖ Gedeelde lijsten waar jij eigenaar van bent"}),s.jsx("li",{children:"‚Ä¢ ‚úÖ Geen gedeelde lijsten van anderen"}),s.jsx("li",{children:"‚Ä¢ ‚úÖ Lokale instellingen (thema, UI)"})]})]})]})]}),N&&s.jsxs("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",role:"alert",children:[s.jsx("strong",{className:"font-bold",children:"Fout: "}),s.jsx("span",{className:"block sm:inline",children:N.message||"Er is een fout opgetreden"})]}),b?.userInfo&&s.jsxs("div",{className:"mt-8 bg-[rgb(var(--card-bg))] rounded-xl shadow-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Gebruikersinformatie"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-[rgb(var(--text-color))]/60",children:"Naam:"}),s.jsx("p",{className:"font-medium",children:b.userInfo.name||"Niet ingesteld"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-[rgb(var(--text-color))]/60",children:"Status:"}),s.jsx("p",{className:"font-medium",children:b.userInfo.hasName?"Voltooid":"Incompleet"})]})]})]})]})};export{h as default};

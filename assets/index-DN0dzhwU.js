const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Settings-B3RWAeU_.js","assets/vendor-CjuAVZ7F.js","assets/ui-CiILanuQ.js","assets/firebase-DuvuO4R-.js","assets/Analytics-BxYwEzmv.js","assets/ThemePage-CD6FC52z.js","assets/Persistence-BcofTes7.js","assets/firebaseBackup-DNKn96ET.js","assets/ShoppingListPage-Bc_8-lIq.js","assets/QRShareModal-XtGkqvR5.js","assets/UserManagementModal-BWoyEZq1.js","assets/QRScannerModal-CgzqOKzR.js","assets/VoiceInput-C80tLIa9.js"])))=>i.map(i=>d[i]);
import{r as e,j as t,R as s,P as r,U as a,C as i,X as n,A as o,W as l,I as c,T as d,a as m,D as u,b as h,S as g,c as p,Z as b,d as x,e as y,f,g as v,L as w,h as j,B as S,i as I,k,Q as N,l as C,m as _,n as E}from"./vendor-CjuAVZ7F.js";import{g as T,d as L,u as R,i as D,a as A,b as O,s as M,o as P,q as U,c as z,w as q,e as B,f as F,h as V,j as $}from"./firebase-DuvuO4R-.js";import{m as H,A as W}from"./ui-CiILanuQ.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const G=e.createContext(),J=({children:s})=>{const[r,a]=e.useState("light"),[i,n]=e.useState("#3b82f6"),[o,l]=e.useState("#a855f7"),[c,d]=e.useState("#ec4899");e.useEffect(()=>{const e=localStorage.getItem("boodschappenlijst_theme")||"light",t=localStorage.getItem("boodschappenlijst_primary")||"#3b82f6",s=localStorage.getItem("boodschappenlijst_secondary")||"#a855f7",r=localStorage.getItem("boodschappenlijst_accent")||"#ec4899";a(e),n(t),l(s),d(r),"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),document.documentElement.setAttribute("data-theme",e),document.documentElement.style.setProperty("--color-primary",m(t)),document.documentElement.style.setProperty("--color-secondary",m(s)),document.documentElement.style.setProperty("--color-accent",m(r))},[]),e.useEffect(()=>{document.documentElement.style.setProperty("--color-primary",m(i)),document.documentElement.style.setProperty("--color-secondary",m(o)),document.documentElement.style.setProperty("--color-accent",m(c))},[r,i,o,c]);const m=e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?`${parseInt(t[1],16)} ${parseInt(t[2],16)} ${parseInt(t[3],16)}`:"0 0 0"},u={theme:r,primaryColor:i,secondaryColor:o,accentColor:c,toggleTheme:()=>{const e="light"===r?"dark":"light";a(e),localStorage.setItem("boodschappenlijst_theme",e),"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),document.documentElement.setAttribute("data-theme",e)},updateColor:(e,t)=>{const s=m(t);switch(e){case"primary":n(t),localStorage.setItem("boodschappenlijst_primary",t),document.documentElement.style.setProperty("--color-primary",s);break;case"secondary":l(t),localStorage.setItem("boodschappenlijst_secondary",t),document.documentElement.style.setProperty("--color-secondary",s);break;case"accent":d(t),localStorage.setItem("boodschappenlijst_accent",t),document.documentElement.style.setProperty("--color-accent",s)}},resetColors:()=>{const e="#3b82f6",t="#a855f7",s="#ec4899";n(e),l(t),d(s),localStorage.setItem("boodschappenlijst_primary",e),localStorage.setItem("boodschappenlijst_secondary",t),localStorage.setItem("boodschappenlijst_accent",s),document.documentElement.style.setProperty("--color-primary",m(e)),document.documentElement.style.setProperty("--color-secondary",m(t)),document.documentElement.style.setProperty("--color-accent",m(s))}};return t.jsx(G.Provider,{value:u,children:s})},Q=e.createContext(),K=()=>{const t=e.useContext(Q);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},Z=({children:s})=>{const[r,a]=e.useState([]),i=e=>{const t=crypto.randomUUID(),s={id:t,...e};return a(e=>[...e,s]),t},n={toasts:r,addToast:i,removeToast:e=>{a(t=>t.filter(t=>t.id!==e))},removeToastByMessage:e=>{a(t=>t.filter(t=>t.message!==e))},clearToasts:()=>{a([])},success:(e,t)=>i({type:"success",message:e,duration:t}),error:(e,t)=>i({type:"error",message:e,duration:t}),warning:(e,t)=>i({type:"warning",message:e,duration:t}),info:(e,t)=>i({type:"info",message:e,duration:t}),deleteToast:(e,t)=>i({type:"delete",message:e,duration:t})};return t.jsx(Q.Provider,{value:n,children:s})},Y={apiKey:"dummy",authDomain:"dummy.firebaseapp.com",projectId:"dummy",storageBucket:"dummy.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:dummy",measurementId:void 0};let X,ee=null,te=null,se=!1,re=null;const ae=async()=>{try{const e="undefined"!=typeof window&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),t="your_api_key_here"===Y.apiKey||"your_project_id"===Y.projectId;if(!Y.apiKey||!Y.projectId)throw new Error("Firebase configuratie ontbreekt");if(e&&t)throw new Error("Firebase configuratie niet ingesteld. Kopieer .env naar .env.local en vul je Firebase credentials in.");X=D(Y),ee=A(X),te=O(X);await M(te);return P(te,e=>{e?(re=e,se=!0):(re=null,se=!1)}),{app:X,db:ee,auth:te,isConnected:se}}catch(e){return se=!1,{app:null,db:null,auth:null,isConnected:se,error:e}}},ie=()=>re?.uid||null,ne=async e=>{try{if(!ee)throw new Error("Firebase not initialized");if(!re)throw new Error("User not authenticated");return(await V(z(ee,"shoppingLists"),{...e,deviceUID:re.uid,creatorId:re.uid,sharedWith:[],items:[],createdAt:new Date,updatedAt:new Date})).id}catch(t){throw t}},oe=async()=>{try{if(!ee||!re)return[];const e=U(z(ee,"shoppingLists"),q("deviceUID","==",re.uid)),t=U(z(ee,"shoppingLists"),q("sharedWith","array-contains",re.uid)),[s,r]=await Promise.all([B(e),B(t)]),a=s.docs.map(e=>({id:e.id,...e.data(),isCreator:!0})),i=r.docs.map(e=>({id:e.id,...e.data(),isCreator:!1})),n=[...a];return i.forEach(e=>{n.find(t=>t.id===e.id)||n.push(e)}),n}catch(e){throw e}},le=async(e,t)=>{try{if(!ee)throw new Error("Firebase not initialized");const s=L(ee,"shoppingLists",e);await R(s,{...t,updatedAt:new Date})}catch(s){throw s}},ce=async e=>{try{if(!ee)throw new Error("Firebase not initialized");await $(L(ee,"shoppingLists",e))}catch(t){throw t}},de=async(e,t)=>{try{if(!ee)throw new Error("Firebase not initialized");const s=L(ee,"shoppingLists",e),r=await T(s);if(!r.exists())throw new Error("List not found");const a=r.data().sharedWith||[];a.includes(t)||await R(s,{sharedWith:[...a,t],updatedAt:new Date})}catch(s){throw s}},me=async(e,t)=>{try{if(!ee)throw new Error("Firebase not initialized");const s=L(ee,"shoppingLists",e),r=await T(s);if(!r.exists())throw new Error("List not found");const a=r.data(),i=(a.sharedWith||[]).filter(e=>e!==t);await R(s,{sharedWith:i,updatedAt:new Date})}catch(s){throw s}},ue=async e=>{try{if(!ee)throw new Error("Firebase not initialized");if(!re)throw new Error("User not authenticated");const t=await T(L(ee,"shoppingLists",e));if(t.exists()){const e=t.data();return{id:t.id,...e,isCreator:e.deviceUID===re?.uid||e.creatorId===re?.uid}}return null}catch(t){if("permission-denied"===t.code)return{permissionDenied:!0,listId:e,error:"permission-denied"};throw t}},he=e=>e.deviceUID===re?.uid,ge=(e,t)=>(t||(t=re?.uid),!(!t||!e)&&(e.deviceUID===t||e.creatorId===t||e.sharedWith&&e.sharedWith.includes(t))),pe=e=>{try{if(!ee||!re)return e([]),()=>{};const t=U(z(ee,"shoppingLists"),q("deviceUID","==",re.uid)),s=U(z(ee,"shoppingLists"),q("sharedWith","array-contains",re.uid));let r=[],a=[];const i=F(t,e=>{r=e.docs.map(e=>({id:e.id,...e.data(),isCreator:!0})),o()}),n=F(s,e=>{a=e.docs.map(e=>({id:e.id,...e.data(),isCreator:!1})),o()}),o=()=>{const t=[...r];a.forEach(e=>{t.find(t=>t.id===e.id)||t.push(e)}),e(t)};return()=>{i(),n()}}catch(t){throw t}},be=Object.freeze(Object.defineProperty({__proto__:null,get app(){return X},get auth(){return te},canDeleteList:he,canEditList:ge,createShoppingList:ne,get db(){return ee},deleteShoppingList:ce,getCurrentUserID:ie,getListById:ue,getShoppingLists:oe,initializeFirebase:ae,get isConnected(){return se},removeUserFromList:me,shareListWithUser:de,subscribeToShoppingLists:pe,updateShoppingList:le},Symbol.toStringTag,{value:"Module"})),xe={},ye=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=s?.nonce||s?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/boodschappen-lijst/"+e}(e))in xe)return;xe[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,a&&r.setAttribute("nonce",a),document.head.appendChild(r),t?new Promise((t,s)=>{r.addEventListener("load",t),r.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})},fe=({message:e="Pagina laden..."})=>t.jsx("div",{className:"min-h-screen-safe flex items-center justify-center bg-[rgb(var(--bg-color))] safe-area-all",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),t.jsx("p",{className:"text-[rgb(var(--text-color))]/80",children:e})]})}),ve=({message:e="Laden..."})=>t.jsx("div",{className:"flex items-center justify-center p-8",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),t.jsx("p",{className:"text-[rgb(var(--text-color))]/60 text-sm",children:e})]})}),we=s.lazy(()=>ye(()=>import("./Settings-B3RWAeU_.js"),__vite__mapDeps([0,1,2,3])).then(e=>({default:e.default}))),je=s.lazy(()=>ye(()=>import("./Analytics-BxYwEzmv.js"),__vite__mapDeps([4,1,2,3])).then(e=>({default:e.default}))),Se=s.lazy(()=>ye(()=>import("./ThemePage-CD6FC52z.js"),__vite__mapDeps([5,1,2,3])).then(e=>({default:e.default}))),Ie=s.lazy(()=>ye(()=>import("./Persistence-BcofTes7.js"),__vite__mapDeps([6,1,7,3,2])).then(e=>({default:e.default}))),ke=s.lazy(()=>ye(()=>import("./ShoppingListPage-Bc_8-lIq.js"),__vite__mapDeps([8,1,9,2,10,3])).then(e=>({default:e.default}))),Ne=s.lazy(()=>ye(()=>import("./QRShareModal-XtGkqvR5.js"),__vite__mapDeps([9,1,2])).then(e=>({default:e.default}))),Ce=s.lazy(()=>ye(()=>import("./QRScannerModal-CgzqOKzR.js"),__vite__mapDeps([11,1,2,3])).then(e=>({default:e.default}))),_e=s.lazy(()=>ye(()=>import("./UserManagementModal-BWoyEZq1.js"),__vite__mapDeps([10,1,2,3])).then(e=>({default:e.default})));s.lazy(()=>ye(()=>import("./VoiceInput-C80tLIa9.js"),__vite__mapDeps([12,1,2,3])).then(e=>({default:e.default})));const Ee=(r,a=t.jsx(fe,{}))=>s.forwardRef((s,i)=>t.jsx(e.Suspense,{fallback:a,children:t.jsx(r,{...s,ref:i})})),Te=r=>s.forwardRef((s,a)=>t.jsx(e.Suspense,{fallback:t.jsx(ve,{message:"Modal laden..."}),children:t.jsx(r,{...s,ref:a})})),Le=e=>e(),Re="Instellingen laden...",De="Analytics laden...",Ae="Thema pagina laden...",Oe="Data beheer laden...",Me="Lijst laden...",Pe=Ee(we,t.jsx(fe,{message:Re})),Ue=Ee(je,t.jsx(fe,{message:De})),ze=Ee(Se,t.jsx(fe,{message:Ae})),qe=Ee(Ie,t.jsx(fe,{message:Oe})),Be=Ee(ke,t.jsx(fe,{message:Me})),Fe=Te(Ne),Ve=Te(Ce),$e=Te(_e),He="boodschappenlijst_secure_2024",We={setItem:(e,t)=>{try{const s=(e=>{if(!e||"string"!=typeof e)return"";let t="";for(let s=0;s<e.length;s++)t+=String.fromCharCode(e.charCodeAt(s)^He.charCodeAt(s%29));return btoa(t)})(t);localStorage.setItem(e,s)}catch(s){localStorage.setItem(e,t)}},getItem:e=>{try{const t=localStorage.getItem(e);if(!t)return null;const s=(e=>{if(!e||"string"!=typeof e)return null;try{const t=atob(e);let s="";for(let e=0;e<t.length;e++)s+=String.fromCharCode(t.charCodeAt(e)^He.charCodeAt(e%29));return s}catch(t){return null}})(t);return null===s?localStorage.getItem(e):s}catch(t){return localStorage.getItem(e)}},removeItem:e=>{localStorage.removeItem(e)},clear:()=>{localStorage.clear()}},Ge="user_name",Je=e=>!!(e&&"string"==typeof e&&e.trim().length>0)&&(We.setItem(Ge,e.trim()),!0),Qe=e=>{if(!e||"string"!=typeof e)return{valid:!1,error:"Naam is verplicht"};const t=e.trim();return 0===t.length?{valid:!1,error:"Naam mag niet leeg zijn"}:t.length<2?{valid:!1,error:"Naam moet minimaal 2 karakters lang zijn"}:t.length>50?{valid:!1,error:"Naam mag maximaal 50 karakters lang zijn"}:/^[a-zA-Z0-9\s\-_.àáâãäåæçèéêëìíîïðñòóôõöøùúûüýþÿ]+$/i.test(t)?{valid:!0,value:t}:{valid:!1,error:"Naam bevat ongeldige karakters"}},Ke=r.shape({id:r.string.isRequired,text:r.string.isRequired,completed:r.bool.isRequired,timestamp:r.number.isRequired,category:r.string,priority:r.oneOf(["low","medium","high"]),notes:r.string,quantity:r.string,unit:r.string,price:r.number,addedBy:r.string,completedBy:r.string,completedAt:r.number}),Ze=r.shape({id:r.string.isRequired,name:r.string.isRequired,items:r.arrayOf(Ke).isRequired,createdAt:r.number.isRequired,updatedAt:r.number.isRequired,createdBy:r.string,sharedWith:r.arrayOf(r.string),color:r.string,icon:r.string,isArchived:r.bool,settings:r.shape({allowDuplicates:r.bool,autoSort:r.bool,showCompleted:r.bool,defaultCategory:r.string})});r.shape({id:r.string.isRequired,name:r.string.isRequired,email:r.string,avatar:r.string,preferences:r.shape({theme:r.string,language:r.string,notifications:r.bool,autoSync:r.bool}),createdAt:r.number.isRequired,lastActive:r.number});const Ye=r.shape({primary:r.string.isRequired,secondary:r.string.isRequired,accent:r.string.isRequired,background:r.string.isRequired,surface:r.string.isRequired,text:r.string.isRequired,textSecondary:r.string.isRequired,border:r.string.isRequired,shadow:r.string.isRequired,success:r.string.isRequired,warning:r.string.isRequired,error:r.string.isRequired,info:r.string.isRequired});r.shape({id:r.string.isRequired,name:r.string.isRequired,colors:Ye.isRequired,isDark:r.bool.isRequired,isCustom:r.bool,createdAt:r.number,updatedAt:r.number});const Xe=r.shape({id:r.string.isRequired,message:r.string.isRequired,type:r.oneOf(["success","error","warning","info","delete"]).isRequired,duration:r.number,action:r.shape({label:r.string.isRequired,onClick:r.func.isRequired}),persistent:r.bool,timestamp:r.number.isRequired});r.shape({code:r.string.isRequired,name:r.string.isRequired,nativeName:r.string.isRequired,flag:r.string.isRequired,rtl:r.bool}),r.shape({isOpen:r.bool.isRequired,data:r.any,onClose:r.func,onConfirm:r.func}),r.shape({listId:r.string.isRequired,listName:r.string.isRequired,timestamp:r.number.isRequired,signature:r.string.isRequired,version:r.string.isRequired}),r.shape({totalLists:r.number.isRequired,totalItems:r.number.isRequired,completedItems:r.number.isRequired,averageItemsPerList:r.number.isRequired,mostUsedCategories:r.arrayOf(r.shape({category:r.string.isRequired,count:r.number.isRequired})).isRequired,activityByDay:r.arrayOf(r.shape({date:r.string.isRequired,items:r.number.isRequired,lists:r.number.isRequired})).isRequired,completionRate:r.number.isRequired,averageCompletionTime:r.number}),r.shape({id:r.string.isRequired,name:r.string.isRequired,type:r.oneOf(["mobile","tablet","desktop"]).isRequired,browser:r.string,os:r.string,lastSync:r.number,isOnline:r.bool.isRequired}),r.shape({isOnline:r.bool.isRequired,lastSync:r.number,pendingChanges:r.number.isRequired,syncInProgress:r.bool.isRequired,error:r.string,storageQuota:r.shape({used:r.number.isRequired,available:r.number.isRequired,percentage:r.number.isRequired})});const et=r.func;r.func,r.func,r.func;const tt=r.oneOfType([r.node,r.arrayOf(r.node)]),st=r.string;r.object,r.oneOfType([r.func,r.shape({current:r.any})]),r.shape({values:r.object.isRequired,errors:r.object,touched:r.object,isValid:r.bool.isRequired,isSubmitting:r.bool.isRequired}),r.shape({required:r.bool,minLength:r.number,maxLength:r.number,pattern:r.instanceOf(RegExp),custom:r.func,message:r.string}),r.shape({path:r.string.isRequired,name:r.string.isRequired,icon:r.string,component:r.elementType,exact:r.bool,private:r.bool}),r.shape({theme:r.string.isRequired,language:r.string.isRequired,notifications:r.bool.isRequired,autoSync:r.bool.isRequired,offlineMode:r.bool.isRequired,dataRetention:r.number.isRequired,backupFrequency:r.oneOf(["never","daily","weekly","monthly"]).isRequired,privacy:r.shape({analytics:r.bool.isRequired,crashReporting:r.bool.isRequired,shareUsageData:r.bool.isRequired}).isRequired,accessibility:r.shape({highContrast:r.bool.isRequired,largeText:r.bool.isRequired,reduceMotion:r.bool.isRequired,screenReader:r.bool.isRequired}).isRequired}),r.shape({isSupported:r.bool.isRequired,isListening:r.bool.isRequired,transcript:r.string.isRequired,confidence:r.number,error:r.string,interimTranscript:r.string,finalTranscript:r.string});const rt=e=>(t,s,r)=>{const a=t[s];if(null!=a&&!e.includes(a))return new Error(`Invalid prop \`${s}\` of value \`${a}\` supplied to \`${r}\`, expected one of ${JSON.stringify(e)}.`)},at=({onNameSet:s})=>{const[r,n]=e.useState(""),[o,l]=e.useState(!1),{error:c,success:d}=K();return t.jsx(H.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs(H.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-[rgb(var(--card-bg))] rounded-2xl shadow-xl max-w-md w-full p-6",children:[t.jsxs("div",{className:"text-center mb-6",children:[t.jsx("div",{className:"w-16 h-16 bg-[rgb(var(--primary-color))]/20 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(a,{className:"w-8 h-8 text-[rgb(var(--primary-color))]"})}),t.jsx("h2",{className:"text-2xl font-bold text-[rgb(var(--card-text))] mb-2",children:"Welkom bij Boodschappenlijst!"}),t.jsx("p",{className:"text-[rgb(var(--text-color))]/70 leading-relaxed",children:"Om samen te kunnen werken aan lijsten, hebben we je naam nodig. Deze wordt getoond bij lijsten die je maakt en items die je toevoegt."})]}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),o)return;const t=Qe(r);if(t.valid){l(!0);try{Je(t.value)?s(t.value):c("Er ging iets mis bij het opslaan van je naam")}catch(a){c("Er ging iets mis bij het opslaan van je naam")}finally{l(!1)}}else c(t.error)},className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-[rgb(var(--text-color))]/80 mb-2",children:"Jouw naam"}),t.jsx("input",{type:"text",value:r,onChange:e=>n(e.target.value),placeholder:"Bijv. Jan Janssen",className:"w-full px-4 py-3 border border-[rgb(var(--border-color))]/30 rounded-xl focus:outline-none focus:ring-2 focus:ring-[rgb(var(--primary-color))] focus:border-transparent bg-[rgb(var(--card-bg))] text-[rgb(var(--card-text))] placeholder-[rgb(var(--text-color))]/40 transition-all duration-200",disabled:o,autoFocus:!0})]}),t.jsx("button",{type:"submit",disabled:!r.trim()||o,className:"w-full flex items-center justify-center px-6 py-3 bg-[rgb(var(--color-primary-button))] hover:opacity-90 text-white rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none transition-all duration-200 font-semibold",children:o?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-3"}),t.jsx("span",{children:"Opslaan..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(i,{className:"w-5 h-5 mr-3"}),t.jsx("span",{children:"Naam Opslaan"})]})})]}),t.jsxs("div",{className:"mt-4 p-3 bg-[rgb(var(--border-color))]/10 rounded-lg",children:[t.jsxs("p",{className:"text-xs text-[rgb(var(--text-color))]/60 text-center",children:["💡 ",t.jsx("strong",{children:"Tip:"})," Je naam wordt lokaal opgeslagen en alleen gedeeld met mensen die toegang hebben tot jouw lijsten."]}),t.jsxs("p",{className:"text-xs text-[rgb(var(--text-color))]/60 text-center mt-2",children:["⚠️ ",t.jsx("strong",{children:"Let op:"})," Bij het wisselen van browser (bijv. van Firefox naar Chrome) moet je je naam opnieuw instellen."]})]})]})})};at.propTypes={onNameSet:et.isRequired};const it=({isOpen:e,onClose:s,onConfirm:r,title:a,message:l,confirmText:c="Bevestigen",cancelText:d="Annuleren",type:m="danger"})=>{if(!e)return null;const u=(()=>{switch(m){case"danger":return{icon:o,iconColor:"text-[rgb(var(--color-error))]",confirmButton:"bg-[rgb(var(--color-error-button))] hover:opacity-90",border:"border-[rgb(var(--color-error))]/20"};case"warning":return{icon:o,iconColor:"text-[rgb(var(--color-warning))]",confirmButton:"bg-[rgb(var(--color-warning-button))] hover:opacity-90",border:"border-[rgb(var(--color-warning))]/20"};default:return{icon:o,iconColor:"text-[rgb(var(--color-info))]",confirmButton:"bg-[rgb(var(--color-info-button))] hover:opacity-90",border:"border-[rgb(var(--color-info))]/20"}}})(),h=u.icon;return t.jsx(W,{children:t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4",children:[t.jsx(H.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),t.jsxs(H.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",duration:.3},className:`relative w-full max-w-sm sm:max-w-md bg-[rgb(var(--card-bg))] rounded-xl sm:rounded-2xl shadow-2xl border ${u.border} overflow-hidden mx-2 sm:mx-0`,onClick:e=>e.stopPropagation(),children:[t.jsx("div",{className:"p-4 sm:p-6 pb-3 sm:pb-4",children:t.jsxs("div",{className:"flex items-start space-x-3 sm:space-x-4",children:[t.jsx("div",{className:`flex-shrink-0 w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[rgb(var(--border-color))]/10 flex items-center justify-center ${u.iconColor}`,children:t.jsx(h,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-base sm:text-lg font-bold text-[rgb(var(--card-text))] mb-1 break-words",children:a}),t.jsx("p",{className:"text-sm text-[rgb(var(--text-color))]/70 leading-relaxed break-words",children:l})]}),t.jsx("button",{onClick:s,className:"flex-shrink-0 w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-[rgb(var(--border-color))]/20 hover:bg-[rgb(var(--border-color))]/30 flex items-center justify-center text-[rgb(var(--text-color))]/60 hover:text-[rgb(var(--card-text))] transition-all duration-200 touch-manipulation",children:t.jsx(n,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})}),t.jsx("div",{className:"px-4 sm:px-6 pb-4 sm:pb-6",children:t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[t.jsx("button",{onClick:s,className:"w-full sm:flex-1 px-4 py-3 sm:py-3 bg-[rgb(var(--border-color))]/20 hover:bg-[rgb(var(--border-color))]/30 text-[rgb(var(--card-text))] rounded-lg sm:rounded-xl font-medium transition-all duration-200 touch-manipulation active:scale-95 sm:hover:scale-105 text-sm sm:text-base",children:d}),t.jsxs("button",{onClick:()=>{r(),s()},className:`w-full sm:flex-1 px-4 py-3 sm:py-3 ${u.confirmButton} text-white rounded-lg sm:rounded-xl font-medium transition-all duration-200 touch-manipulation active:scale-95 sm:hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center space-x-2 text-sm sm:text-base`,children:[t.jsx(i,{className:"w-4 h-4"}),t.jsx("span",{children:c})]})]})}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[rgb(var(--primary-color))]/5 via-transparent to-[rgb(var(--secondary-color))]/5 pointer-events-none"})]})]})})};it.propTypes={isOpen:r.bool.isRequired,onClose:et.isRequired,onConfirm:et.isRequired,title:r.string.isRequired,message:r.string.isRequired,confirmText:r.string,cancelText:r.string,type:rt(["danger","warning","info"])},it.defaultProps={confirmText:"Bevestigen",cancelText:"Annuleren",type:"danger"};const nt=({error:e,onRetry:s})=>{const r=(()=>{switch(e?.message){case"Firebase configuratie ontbreekt":return{title:"Firebase configuratie ontbreekt",description:"De Firebase configuratie is niet ingesteld. Controleer je environment variables.",action:"Configureer Firebase"};case"Network Error":case"Failed to fetch":return{title:"Geen internetverbinding",description:"Controleer je internetverbinding en probeer het opnieuw.",action:"Probeer opnieuw"};default:return{title:"Verbindingsprobleem",description:e?.message||"Er is een probleem met de verbinding naar de server.",action:"Probeer opnieuw"}}})();return t.jsx(H.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"min-h-screen flex items-center justify-center p-4 bg-[rgb(var(--bg-color))]",children:t.jsxs("div",{className:"max-w-md w-full bg-[rgb(var(--card-bg))] rounded-lg shadow-xl p-8 text-center",children:[t.jsx("div",{className:"mb-6",children:"Firebase configuratie ontbreekt"===e?.message?t.jsx(o,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}):t.jsx(l,{className:"w-16 h-16 text-red-500 mx-auto mb-4"})}),t.jsx("h2",{className:"text-2xl font-bold text-[rgb(var(--text-color))] mb-4",children:r.title}),t.jsx("p",{className:"text-[rgb(var(--text-color))]/80 mb-6",children:r.description}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("button",{onClick:s,className:"w-full px-4 py-3 bg-[rgb(var(--primary-color))] hover:opacity-90 text-white rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:r.action}),"Firebase configuratie ontbreekt"===e?.message&&t.jsxs("div",{className:"text-sm text-[rgb(var(--text-color))]/60 text-left",children:[t.jsx("p",{className:"mb-2",children:t.jsx("strong",{children:"Vereiste environment variables:"})}),t.jsx("pre",{className:"bg-[rgb(var(--border-color))]/20 p-3 rounded text-xs overflow-x-auto",children:"VITE_FIREBASE_API_KEY=your_api_key VITE_FIREBASE_AUTH_DOMAIN=your_project.firebaseapp.com VITE_FIREBASE_PROJECT_ID=your_project_id VITE_FIREBASE_STORAGE_BUCKET=your_project.appspot.com VITE_FIREBASE_MESSAGING_SENDER_ID=your_sender_id VITE_FIREBASE_APP_ID=your_app_id"})]})]}),t.jsx("div",{className:"mt-6 pt-4 border-t border-[rgb(var(--border-color))]/50",children:t.jsx("p",{className:"text-xs text-[rgb(var(--text-color))]/60",children:"De app werkt momenteel offline. Je kunt nog steeds lijsten maken en bewerken, maar de gegevens worden niet opgeslagen."})})]})})};var ot={};const lt=new class{constructor(){this.metrics=new Map,this.observers=new Map,this.isEnabled="true"===ot.REACT_APP_ENABLE_PERF_MONITORING,this.thresholds={renderTime:16,componentMount:100,apiCall:1e3,bundleSize:256e3,memoryUsage:52428800},this.isEnabled&&this.initializeObservers()}initializeObservers(){if("PerformanceObserver"in window){try{const e=new PerformanceObserver(e=>{for(const t of e.getEntries())this.recordMetric("longTask",{duration:t.duration,startTime:t.startTime,name:t.name}),t.duration});e.observe({entryTypes:["longtask"]}),this.observers.set("longTask",e)}catch(e){}try{const e=new PerformanceObserver(e=>{for(const t of e.getEntries())t.hadRecentInput||this.recordMetric("layoutShift",{value:t.value,startTime:t.startTime,sources:t.sources})});e.observe({entryTypes:["layout-shift"]}),this.observers.set("layoutShift",e)}catch(e){}try{const e=new PerformanceObserver(e=>{const t=e.getEntries(),s=t[t.length-1];this.recordMetric("largestContentfulPaint",{value:s.startTime,element:s.element?.tagName,url:s.url})});e.observe({entryTypes:["largest-contentful-paint"]}),this.observers.set("lcp",e)}catch(e){}}"memory"in performance&&setInterval(()=>{this.recordMemoryUsage()},3e4)}recordMetric(e,t){if(!this.isEnabled)return;const s=performance.now(),r={name:e,timestamp:s,data:t,id:`${e}_${s}_${Math.random().toString(36).substr(2,9)}`};this.metrics.has(e)||this.metrics.set(e,[]);const a=this.metrics.get(e);a.push(r),a.length>100&&a.shift(),this.checkThresholds(e,t)}checkThresholds(e,t){"object"==typeof t&&(t.value||t.duration),this.thresholds[e]}recordMemoryUsage(){if("memory"in performance){const e=performance.memory;this.recordMetric("memoryUsage",{used:e.usedJSHeapSize,total:e.totalJSHeapSize,limit:e.jsHeapSizeLimit,percentage:e.usedJSHeapSize/e.jsHeapSizeLimit*100})}}measureRender(e,t){if(!this.isEnabled)return t();const s=performance.now(),r=t(),a=performance.now(),i=a-s;return this.recordMetric("componentRender",{component:e,duration:i,startTime:s,endTime:a}),r}async measureAsync(e,t){if(!this.isEnabled)return await t();const s=performance.now();try{const r=await t(),a=performance.now(),i=a-s;return this.recordMetric("asyncOperation",{operation:e,duration:i,startTime:s,endTime:a,success:!0}),r}catch(r){const t=performance.now(),a=t-s;throw this.recordMetric("asyncOperation",{operation:e,duration:a,startTime:s,endTime:t,success:!1,error:r.message}),r}}mark(e,t={}){this.isEnabled&&(performance.mark(e),this.recordMetric("milestone",{name:e,timestamp:performance.now(),...t}))}measure(e,t,s){if(this.isEnabled)try{performance.measure(e,t,s);const r=performance.getEntriesByName(e,"measure")[0];this.recordMetric("measurement",{name:e,duration:r.duration,startTime:r.startTime})}catch(r){}}getSummary(){if(!this.isEnabled)return null;const e={};for(const[t,s]of this.metrics.entries()){if(0===s.length)continue;const r=s.map(e=>{const t=e.data;return"object"==typeof t?t.duration||t.value||0:t}).filter(e=>"number"==typeof e&&!isNaN(e));0!==r.length&&(e[t]={count:r.length,min:Math.min(...r),max:Math.max(...r),avg:r.reduce((e,t)=>e+t,0)/r.length,p95:this.percentile(r,.95),p99:this.percentile(r,.99),recent:s.slice(-10).map(e=>({timestamp:e.timestamp,data:e.data}))})}return e}percentile(e,t){const s=[...e].sort((e,t)=>e-t);return s[Math.ceil(s.length*t)-1]||0}getCoreWebVitals(){const e=this.getSummary();return e?{lcp:e.largestContentfulPaint?.recent?.[0]?.data?.value||null,cls:e.layoutShift?e.layoutShift.recent.reduce((e,t)=>e+(t.data?.value||0),0):null,fid:null,avgRenderTime:e.componentRender?.avg||null,longTaskCount:e.longTask?.count||0,memoryUsage:e.memoryUsage?.recent?.[0]?.data?.percentage||null}:null}exportData(){return this.isEnabled?{timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent,metrics:Object.fromEntries(this.metrics),summary:this.getSummary(),coreWebVitals:this.getCoreWebVitals(),thresholds:this.thresholds}:null}clear(){this.metrics.clear(),performance.clearMarks(),performance.clearMeasures()}cleanup(){for(const e of this.observers.values())e.disconnect();this.observers.clear()}},ct=e=>({measureRender:s.useCallback(t=>lt.measureRender(e,t),[e]),measureAsync:s.useCallback((t,s)=>lt.measureAsync(`${e}.${t}`,s),[e]),mark:s.useCallback((t,s)=>{lt.mark(`${e}.${t}`,s)},[e]),getSummary:()=>lt.getSummary(),getCoreWebVitals:()=>lt.getCoreWebVitals()}),dt=()=>{},mt=s.memo(({toast:s,onRemove:r})=>{const{measureRender:a}=ct("Toast"),{id:o,type:l,message:u,duration:h=2500}=s,g=e.useCallback(()=>{r(o)},[r,o]);e.useEffect(()=>{const e=setTimeout(g,h);return()=>clearTimeout(e)},[g,h]);const p=e.useMemo(()=>{const e={className:"w-full h-full"};switch(l){case"success":return t.jsx(i,{...e});case"error":return t.jsx(n,{...e});case"warning":return t.jsx(m,{...e});case"info":default:return t.jsx(c,{...e});case"delete":return t.jsx(d,{...e})}},[l]),b=e.useMemo(()=>{const e={color:"white",backdropFilter:"blur(4px)"};switch(l){case"success":return{...e,backgroundColor:"rgba(34, 197, 94, 0.9)"};case"error":return{...e,backgroundColor:"rgba(239, 68, 68, 0.9)"};case"warning":return{...e,backgroundColor:"rgba(249, 115, 22, 0.9)"};case"info":return{...e,backgroundColor:"rgba(59, 130, 246, 0.9)"};case"delete":return{...e,backgroundColor:"rgba(220, 38, 38, 0.9)"};default:return{...e,backgroundColor:"rgba(75, 85, 99, 0.9)"}}},[l]);return a(()=>t.jsxs(H.div,{initial:{opacity:0,y:-50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.9},style:b,className:"flex items-center space-x-2 sm:space-x-3 px-3 sm:px-4 py-2 sm:py-3 rounded-lg sm:rounded-xl shadow-lg border border-white/20 max-w-xs sm:max-w-sm lg:max-w-md mx-auto mb-2",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5",children:p})}),t.jsx("p",{className:"flex-1 font-medium text-xs sm:text-sm lg:text-base",children:u}),t.jsx("button",{onClick:g,className:"flex-shrink-0 opacity-70 hover:opacity-100 transition-opacity",children:t.jsx(n,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}))});mt.displayName="Toast",mt.propTypes={toast:Xe.isRequired,onRemove:et.isRequired};const ut=s.memo(({toasts:e,removeToast:s})=>t.jsx("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[100] pointer-events-none",children:t.jsx("div",{className:"pointer-events-auto",children:t.jsx(W,{children:e.map(e=>t.jsx(mt,{toast:e,onRemove:s},e.id))})})}));ut.displayName="ToastContainer",ut.propTypes={toasts:r.arrayOf(Xe).isRequired,removeToast:et.isRequired};const ht=new class{constructor(){this.registration=null,this.updateAvailable=!1,this.onUpdateAvailable=null,this.onUpdateInstalled=null,this.onUpdateError=null,this.currentVersion=null,this.latestVersion=null,this.init()}async init(){if("serviceWorker"in navigator)try{this.registration=await navigator.serviceWorker.register("./sw.js",{scope:"./",updateViaCache:"none"}),this.registration.addEventListener("updatefound",()=>{this.handleUpdateFound()}),this.registration.waiting&&this.showUpdateAvailable(),navigator.serviceWorker.addEventListener("controllerchange",()=>{this.onUpdateInstalled?this.onUpdateInstalled():window.location.reload()}),this.startUpdateCheck()}catch(e){this.onUpdateError&&this.onUpdateError(e)}}handleUpdateFound(){const e=this.registration.installing;e.addEventListener("statechange",()=>{"installed"===e.state&&navigator.serviceWorker.controller&&this.showUpdateAvailable()})}showUpdateAvailable(){this.updateAvailable=!0,this.onUpdateAvailable&&this.onUpdateAvailable()}async applyUpdate(){return!(!this.registration||!this.registration.waiting)&&(this.registration.waiting.postMessage({type:"SKIP_WAITING"}),!0)}async checkForUpdates(){try{const e=await this.checkVersionUpdate();return this.registration?(await this.registration.update(),this.registration.waiting?(this.showUpdateAvailable(),!0):!!this.registration.installing||!!e&&(this.showUpdateAvailable(),!0)):e}catch(e){return!1}}startUpdateCheck(){setInterval(()=>{this.checkForUpdates()},3e5),document.addEventListener("visibilitychange",()=>{document.hidden||setTimeout(()=>{this.checkForUpdates()},1e3)}),setTimeout(()=>{this.checkForUpdates()},2e3)}async getVersionInfo(){if(this.registration&&this.registration.active)try{return await new Promise((e,t)=>{const s=new MessageChannel;s.port1.onmessage=t=>{"VERSION_INFO"===t.data.type&&e(t.data.version)};const r=setTimeout(()=>{t(new Error("Service worker timeout"))},1e3);s.port1.onmessage=t=>{clearTimeout(r),"VERSION_INFO"===t.data.type&&e(t.data.version)},this.registration.active.postMessage({type:"GET_VERSION"},[s.port2])})}catch(e){}try{const e=await fetch("/manifest.json",{cache:"no-cache",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}),t=await e.json();return t.version||"1.0.0"}catch(e){return"1.0.0"}}async getManifestVersion(){try{const e=await fetch("/manifest.json");return(await e.json()).version||"1.0.0"}catch(e){return"1.0.0"}}compareVersions(e,t){const s=e.split(".").map(Number),r=t.split(".").map(Number);for(let a=0;a<Math.max(s.length,r.length);a++){const e=s[a]||0,t=r[a]||0;if(e<t)return-1;if(e>t)return 1}return 0}async checkVersionUpdate(){try{this.currentVersion=await this.getVersionInfo();const e=await fetch("/manifest.json",{cache:"no-cache",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}),t=await e.json();this.latestVersion=t.version||"1.0.0";return this.compareVersions(this.currentVersion,this.latestVersion)<0&&(this.updateAvailable=!0,!0)}catch(e){return!1}}async getVersionDetails(){try{const e=await this.getVersionInfo(),t=await fetch("/manifest.json",{cache:"no-cache",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}),s=(await t.json()).version||"1.0.0";this.currentVersion=e,this.latestVersion=s;return{current:e,latest:s,updateAvailable:this.compareVersions(e,s)<0}}catch(e){const t=await this.getVersionInfo();return{current:t,latest:t,updateAvailable:!1}}}forceRefresh(){"caches"in window?caches.keys().then(e=>Promise.all(e.map(e=>caches.delete(e)))).then(()=>{window.location.reload(!0)}).catch(e=>{window.location.reload(!0)}):window.location.reload(!0)}async forceClearAll(){try{if(this.registration&&await this.registration.unregister(),"caches"in window){const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}localStorage.clear(),sessionStorage.clear(),window.location.reload(!0)}catch(e){window.location.reload(!0)}}isUpdateAvailable(){return this.updateAvailable||this.registration&&this.registration.waiting||this.registration&&this.registration.installing}async unregister(){if(this.registration){return await this.registration.unregister()}return!1}},gt=()=>{const[s,r]=e.useState(!1),[a,i]=e.useState(!1),[o,l]=e.useState(!1),[c,d]=e.useState(null),{success:m,info:p,error:b}=K();e.useEffect(()=>{ht.onUpdateAvailable=()=>{r(!0),p("🔄 Nieuwe versie beschikbaar! Klik om bij te werken.",5e3)},ht.onUpdateInstalled=()=>{i(!1),r(!1),m("✅ App bijgewerkt! Nieuwe functies zijn nu beschikbaar.",3e3)},ht.onUpdateError=e=>{i(!1),b("❌ Update mislukt. Probeer de pagina te vernieuwen.",5e3)};const e=e=>{e.preventDefault(),d(e),l(!0)};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",()=>{l(!1),d(null),m("📱 App geïnstalleerd! Je kunt het nu vanaf je startscherm gebruiken.",4e3)}),()=>{window.removeEventListener("beforeinstallprompt",e)}},[m,p,b]);const x=()=>{r(!1)},y=()=>{l(!1),d(null)};return t.jsxs(t.Fragment,{children:[t.jsx(W,{children:s&&t.jsx(H.div,{initial:{opacity:0,y:100,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:100,scale:.9},className:"fixed bottom-4 right-4 left-4 md:left-auto md:w-96 z-50 safe-area-all",children:t.jsx("div",{className:"bg-[rgb(var(--card-bg))] border border-[rgb(var(--border-color))]/20 rounded-2xl shadow-2xl p-4 backdrop-blur-lg",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:t.jsx(u,{className:"w-5 h-5 text-white"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-[rgb(var(--card-text))] mb-1",children:"🚀 Nieuwe versie beschikbaar!"}),t.jsx("p",{className:"text-xs text-[rgb(var(--text-color))]/70 mb-3",children:"Er is een update beschikbaar met nieuwe functies en verbeteringen."}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:async()=>{i(!0),p("🔄 App wordt bijgewerkt...",2e3);try{await ht.applyUpdate()||setTimeout(()=>{ht.forceRefresh()},1e3)}catch(e){i(!1),b("Update mislukt. Probeer de pagina handmatig te vernieuwen.",5e3)}},disabled:a,className:"flex items-center space-x-1 px-3 py-1.5 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-lg text-xs font-medium shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none transition-all duration-200",children:a?t.jsxs(t.Fragment,{children:[t.jsx(h,{className:"w-3 h-3 animate-spin"}),t.jsx("span",{children:"Bijwerken..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(u,{className:"w-3 h-3"}),t.jsx("span",{children:"Nu bijwerken"})]})}),t.jsx("button",{onClick:x,className:"px-3 py-1.5 text-[rgb(var(--text-color))]/60 hover:text-[rgb(var(--card-text))] rounded-lg text-xs font-medium transition-colors duration-200",children:"Later"})]})]}),t.jsx("button",{onClick:x,className:"flex-shrink-0 p-1 text-[rgb(var(--text-color))]/40 hover:text-[rgb(var(--card-text))] rounded-lg transition-colors duration-200",children:t.jsx(n,{className:"w-4 h-4"})})]})})})}),t.jsx(W,{children:o&&t.jsx(H.div,{initial:{opacity:0,y:100,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:100,scale:.9},className:"fixed bottom-4 right-4 left-4 md:left-auto md:w-96 z-50 safe-area-all",children:t.jsx("div",{className:"bg-[rgb(var(--card-bg))] border border-[rgb(var(--border-color))]/20 rounded-2xl shadow-2xl p-4 backdrop-blur-lg",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center",children:t.jsx(g,{className:"w-5 h-5 text-white"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-[rgb(var(--card-text))] mb-1",children:"📱 Installeer de app"}),t.jsx("p",{className:"text-xs text-[rgb(var(--text-color))]/70 mb-3",children:"Installeer de app op je apparaat voor snellere toegang en offline gebruik."}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsxs("button",{onClick:async()=>{if(c)try{"accepted"===(await c.prompt()).outcome&&p("📱 App wordt geïnstalleerd...",2e3),d(null),l(!1)}catch(e){b("Installatie mislukt. Probeer het later opnieuw.",3e3)}},className:"flex items-center space-x-1 px-3 py-1.5 bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white rounded-lg text-xs font-medium shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:[t.jsx(g,{className:"w-3 h-3"}),t.jsx("span",{children:"Installeren"})]}),t.jsx("button",{onClick:y,className:"px-3 py-1.5 text-[rgb(var(--text-color))]/60 hover:text-[rgb(var(--card-text))] rounded-lg text-xs font-medium transition-colors duration-200",children:"Niet nu"})]})]}),t.jsx("button",{onClick:y,className:"flex-shrink-0 p-1 text-[rgb(var(--text-color))]/40 hover:text-[rgb(var(--card-text))] rounded-lg transition-colors duration-200",children:t.jsx(n,{className:"w-4 h-4"})})]})})})})]})},pt=s.memo(({onClose:s})=>{const[r,a]=e.useState(null),[i,l]=e.useState(null),[c,d]=e.useState(null),[m,u]=e.useState(5e3);if(!("undefined"!=typeof window&&"true"===new URLSearchParams(window.location.search).get("dev")))return null;e.useEffect(()=>{const e=()=>{const e=lt.getSummary(),t=lt.getCoreWebVitals(),s=(()=>{const e=lt.getSummary();if(!e)return{passed:!0,violations:[]};const t=[],s=16,r=50,a=80;if(e.componentRender&&(e.componentRender.avg>s&&t.push({metric:"avgRenderTime",actual:e.componentRender.avg,budget:s,severity:"warning"}),e.componentRender.max>r&&t.push({metric:"maxRenderTime",actual:e.componentRender.max,budget:r,severity:"error"})),e.memoryUsage){const s=Math.max(...e.memoryUsage.recent.map(e=>e.data?.percentage||0));s>a&&t.push({metric:"maxMemoryUsage",actual:s,budget:a,severity:"warning"})}return{passed:0===t.length,violations:t,summary:e}})();a(e),l(t),d(s)};e();const t=setInterval(e,m);return()=>clearInterval(t)},[m]);const h=(e,t=2)=>null==e?"N/A":"number"==typeof e?e.toFixed(t):e,g=(e,t,s=!1)=>{if(null==e)return"text-gray-400";return(s?e<t:e>t)?"text-green-500":"text-red-500"},f=({title:e,value:s,unit:r,threshold:a,icon:i,inverted:n=!1})=>t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-300",children:e}),t.jsx(i,{className:"w-4 h-4 text-gray-400"})]}),t.jsxs("div",{className:"flex items-baseline space-x-2",children:[t.jsx("span",{className:`text-2xl font-bold ${g(s,a,n)}`,children:h(s)}),r&&t.jsx("span",{className:"text-sm text-gray-400",children:r})]}),a&&t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Target: ",n?"<":">"," ",a,r]})]}),v=()=>t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center",children:[t.jsx(b,{className:"w-5 h-5 mr-2"}),"Core Web Vitals"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx(f,{title:"LCP (Largest Contentful Paint)",value:i?.lcp,unit:"ms",threshold:2500,icon:x,inverted:!0}),t.jsx(f,{title:"CLS (Cumulative Layout Shift)",value:i?.cls,threshold:.1,icon:p,inverted:!0}),t.jsx(f,{title:"Memory Usage",value:i?.memoryUsage,unit:"%",threshold:80,icon:p,inverted:!0})]})]}),w=()=>t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center",children:[t.jsx(p,{className:"w-5 h-5 mr-2"}),"Performance Metrics"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsx(f,{title:"Avg Render Time",value:r?.componentRender?.avg,unit:"ms",threshold:16,icon:x,inverted:!0}),t.jsx(f,{title:"Max Render Time",value:r?.componentRender?.max,unit:"ms",threshold:50,icon:x,inverted:!0}),t.jsx(f,{title:"Long Tasks",value:i?.longTaskCount,threshold:0,icon:o,inverted:!0}),t.jsx(f,{title:"Render Count",value:r?.componentRender?.count,icon:p})]})]}),j=()=>c?.violations?.length?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center",children:[t.jsx(o,{className:"w-5 h-5 mr-2 text-yellow-500"}),"Budget Violations"]}),t.jsx("div",{className:"space-y-2",children:c.violations.map((e,s)=>t.jsx("div",{className:"border rounded-lg p-3 "+("error"===e.severity?"bg-red-900/20 border-red-500/30 text-red-400":"bg-yellow-900/20 border-yellow-500/30 text-yellow-400"),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"font-medium",children:e.metric}),t.jsxs("span",{className:"text-sm",children:[h(e.actual)," ",">"," ",e.budget]})]})},s))})]}):t.jsx("div",{className:"bg-green-900/20 border border-green-500/30 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center text-green-400",children:[t.jsx(y,{className:"w-5 h-5 mr-2"}),t.jsx("span",{className:"font-medium",children:"All performance budgets passed!"})]})}),S=()=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("label",{className:"text-sm text-gray-300",children:["Refresh Interval:",t.jsxs("select",{value:m,onChange:e=>u(Number(e.target.value)),className:"ml-2 bg-gray-700 border border-gray-600 rounded px-2 py-1 text-white text-sm",children:[t.jsx("option",{value:1e3,children:"1s"}),t.jsx("option",{value:5e3,children:"5s"}),t.jsx("option",{value:1e4,children:"10s"}),t.jsx("option",{value:3e4,children:"30s"})]})]}),t.jsx("button",{onClick:()=>{lt.clear(),a(null),l(null),d(null)},className:"bg-gray-700 hover:bg-gray-600 text-white text-sm px-3 py-1 rounded border border-gray-600",children:"Clear Metrics"}),t.jsx("button",{onClick:dt,className:"bg-blue-700 hover:bg-blue-600 text-white text-sm px-3 py-1 rounded",children:"Log to Console"})]}),t.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:t.jsx(n,{className:"w-5 h-5"})})]});return t.jsx(H.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs(H.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"bg-gray-900 rounded-xl shadow-2xl border border-gray-700 w-full max-w-6xl max-h-[90vh] overflow-hidden",children:[t.jsx("div",{className:"p-6 border-b border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center",children:[t.jsx(p,{className:"w-7 h-7 mr-3 text-blue-500"}),"Performance Dashboard"]}),t.jsx("div",{className:"text-sm text-gray-400",children:"Development Mode Only"})]})}),t.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)] space-y-8",children:[t.jsx(S,{}),i&&t.jsx(v,{}),r&&t.jsx(w,{}),c&&t.jsx(j,{}),r&&t.jsxs("details",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[t.jsx("summary",{className:"p-4 cursor-pointer text-white font-medium hover:bg-gray-750",children:"Raw Performance Data"}),t.jsx("div",{className:"p-4 border-t border-gray-700",children:t.jsx("pre",{className:"text-xs text-gray-300 overflow-auto max-h-64 bg-gray-900 p-3 rounded",children:JSON.stringify({metrics:r,coreWebVitals:i,budgetStatus:c},null,2)})})]})]})]})})});pt.displayName="PerformanceDashboard",pt.propTypes={onClose:r.func.isRequired};const bt="network",xt="firebase",yt="validation",ft="permission",vt="unknown",wt="storage",jt="qr_code",St="low",It="medium",kt="high",Nt="critical",Ct={maxRetries:3,baseDelay:1e3,maxDelay:1e4,backoffMultiplier:2};const _t=new class{constructor(){this.errorLog=[],this.retryAttempts=new Map,this.setupGlobalErrorHandlers()}setupGlobalErrorHandlers(){window.addEventListener("unhandledrejection",e=>{this.logError(e.reason,{type:vt,severity:kt,source:"unhandledrejection"})}),window.addEventListener("error",e=>{this.logError(e.error,{type:vt,severity:It,source:"global",filename:e.filename,lineno:e.lineno,colno:e.colno})})}logError(e,t={}){const s={id:this.generateErrorId(),timestamp:(new Date).toISOString(),error:{message:e?.message||String(e),stack:e?.stack,name:e?.name},context:{type:t.type||vt,severity:t.severity||It,component:t.component,action:t.action,userId:this.getCurrentUserId(),userAgent:navigator.userAgent,url:window.location.href,...t}};if(this.errorLog.push(s),this.errorLog.length>100&&(this.errorLog=this.errorLog.slice(-100)),window.analytics)try{window.analytics.track("Error Occurred",{errorId:s.id,errorType:s.context.type,errorSeverity:s.context.severity,errorMessage:s.error.message,component:s.context.component})}catch(r){}return s.id}getUserFriendlyMessage(e,t={}){const s=t.type||this.categorizeError(e),r={[bt]:{[St]:"Verbinding is traag. Probeer het opnieuw.",[It]:"Geen internetverbinding. Controleer je verbinding.",[kt]:"Netwerkfout. Probeer het later opnieuw.",[Nt]:"Ernstige netwerkfout. Herlaad de pagina."},[xt]:{[St]:"Gegevens worden gesynchroniseerd...",[It]:"Kan gegevens niet opslaan. Probeer het opnieuw.",[kt]:"Database fout. Controleer je internetverbinding.",[Nt]:"Kan geen verbinding maken met de database."},[ft]:{[St]:"Beperkte toegang tot deze functie.",[It]:"Je hebt geen toestemming voor deze actie.",[kt]:"Toegang geweigerd. Log opnieuw in.",[Nt]:"Account toegang geblokkeerd."},[yt]:{[St]:"Controleer je invoer.",[It]:"Ongeldige gegevens ingevoerd.",[kt]:"Gegevens kunnen niet worden verwerkt.",[Nt]:"Ernstige validatiefout."},[jt]:{[St]:"QR-code niet duidelijk. Probeer opnieuw.",[It]:"Ongeldige QR-code. Controleer de code.",[kt]:"QR-code kan niet worden gelezen.",[Nt]:"QR-scanner fout."},[wt]:{[St]:"Gegevens worden opgeslagen...",[It]:"Kan gegevens niet opslaan lokaal.",[kt]:"Opslagfout. Ruimte beschikbaar?",[Nt]:"Kritieke opslagfout."}},a=t.severity||It,i=r[s];if(i&&i[a])return i[a];return{[St]:"Er is een klein probleem opgetreden.",[It]:"Er ging iets mis. Probeer het opnieuw.",[kt]:"Er is een fout opgetreden. Herlaad de pagina.",[Nt]:"Kritieke fout. Neem contact op met ondersteuning."}[a]||"Er is een onbekende fout opgetreden."}categorizeError(e){if(!e)return vt;const t=e.message?.toLowerCase()||"",s=e.code?.toLowerCase()||"";return t.includes("network")||t.includes("fetch")||t.includes("connection")||s.includes("network")?bt:t.includes("firebase")||s.includes("auth")||s.includes("firestore")||t.includes("permission-denied")?xt:t.includes("permission")||t.includes("unauthorized")||s.includes("permission-denied")||s.includes("unauthenticated")?ft:t.includes("validation")||t.includes("invalid")||t.includes("required")||t.includes("format")?yt:t.includes("qr")||t.includes("scan")||t.includes("camera")||t.includes("decode")?jt:t.includes("storage")||t.includes("quota")||t.includes("localstorage")||t.includes("indexeddb")?wt:vt}async withRetry(e,t={}){const s={...Ct,...t},r=this.generateErrorId();let a;for(let n=0;n<=s.maxRetries;n++)try{const t=await e();return n>0&&this.retryAttempts.delete(r),t}catch(i){if(a=i,this.logError(i,{type:this.categorizeError(i),severity:n===s.maxRetries?kt:St,component:t.component||"withRetry",action:t.action||"retry",attempt:n+1,maxRetries:s.maxRetries+1}),n===s.maxRetries)break;const e=Math.min(s.baseDelay*Math.pow(s.backoffMultiplier,n),s.maxDelay)+1e3*Math.random();await this.sleep(e)}throw a}async handleFirebaseOperation(e,t={}){return this.withRetry(e,{maxRetries:2,component:t.component||"Firebase",action:t.action||"operation"})}getCurrentUserId(){try{return window.persistentStorage&&window.persistentStorage.getItem("user_id")||"anonymous"}catch{return"anonymous"}}generateErrorId(){return`err_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}sleep(e){return new Promise(t=>setTimeout(t,e))}getErrorStats(){const e=Date.now(),t=e-36e5,s=e-864e5,r=this.errorLog.filter(e=>new Date(e.timestamp).getTime()>t),a=this.errorLog.filter(e=>new Date(e.timestamp).getTime()>s),i={},n={};return a.forEach(e=>{const t=e.context.type,s=e.context.severity;i[t]=(i[t]||0)+1,n[s]=(n[s]||0)+1}),{total:this.errorLog.length,lastHour:r.length,lastDay:a.length,byType:i,bySeverity:n,mostRecent:this.errorLog[this.errorLog.length-1]}}clearErrorLog(){this.errorLog=[],this.retryAttempts.clear()}exportErrorLog(){return{errors:this.errorLog,stats:this.getErrorStats(),exportedAt:(new Date).toISOString()}}};"undefined"!=typeof window&&(window.errorHandler=_t);class Et extends s.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null,retryCount:0,isRetrying:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),_t.logError(e,"react_error_boundary",{componentStack:t.componentStack,errorBoundary:this.props.fallbackComponent||"default",retryCount:this.state.retryCount})}handleRetry=async()=>{this.setState({isRetrying:!0});try{await new Promise(e=>setTimeout(e,1e3)),this.setState({hasError:!1,error:null,errorInfo:null,retryCount:this.state.retryCount+1,isRetrying:!1})}catch(e){this.setState({isRetrying:!1})}};handleReload=()=>{window.location.reload()};render(){return this.state.hasError?this.props.fallback?this.props.fallback(this.state.error,this.handleRetry):t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:t.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:t.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Er ging iets mis"}),t.jsx("p",{className:"text-sm text-gray-500 mb-6",children:this.props.message||"De applicatie heeft een onverwachte fout ondervonden. Probeer het opnieuw of herlaad de pagina."}),!1,t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsx("button",{onClick:this.handleRetry,disabled:this.state.isRetrying,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 flex items-center justify-center",children:this.state.isRetrying?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Opnieuw proberen..."]}):"Opnieuw proberen"}),t.jsx("button",{onClick:this.handleReload,className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200",children:"Pagina herladen"})]}),this.state.retryCount>0&&t.jsxs("p",{className:"mt-3 text-xs text-gray-400",children:["Pogingen: ",this.state.retryCount]})]})})}):this.props.children}}Et.propTypes={children:tt.isRequired,fallback:r.func,fallbackComponent:r.string,message:r.string};const Tt="boodschappenlijst_v2_",Lt="boodschappenlijst_backup_",Rt="boodschappenlijst_session_";const Dt=new class{constructor(){this.storageStrategies=["localStorage","sessionStorage","indexedDB","cookieStorage","memoryStorage"],this.memoryCache=new Map,this.initializeStorage()}async initializeStorage(){this.availableStorage={};try{localStorage.setItem("test","test"),localStorage.removeItem("test"),this.availableStorage.localStorage=!0}catch(e){this.availableStorage.localStorage=!1}try{sessionStorage.setItem("test","test"),sessionStorage.removeItem("test"),this.availableStorage.sessionStorage=!0}catch(e){this.availableStorage.sessionStorage=!1}try{this.availableStorage.indexedDB="indexedDB"in window,this.availableStorage.indexedDB&&await this.initIndexedDB()}catch(e){this.availableStorage.indexedDB=!1}this.availableStorage.cookieStorage=!0,this.availableStorage.memoryStorage=!0}async initIndexedDB(){return new Promise((e,t)=>{const s=indexedDB.open("BoodschappenlijstDB",1);s.onerror=()=>t(s.error),s.onsuccess=()=>{this.db=s.result,e()},s.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("userData")||t.createObjectStore("userData",{keyPath:"key"})}})}encrypt(e){try{const t=JSON.stringify(e),s=`${Date.now().toString()}:${t}`,r="boodschappenlijst_secure_v2_2024";let a="";for(let e=0;e<s.length;e++)a+=String.fromCharCode(s.charCodeAt(e)^r.charCodeAt(e%r.length));return btoa(a)}catch(t){return JSON.stringify(e)}}decrypt(e){try{try{return JSON.parse(e)}catch{}if(!/^[A-Za-z0-9+/=]+$/.test(e.trim()))try{return JSON.parse(e)}catch{return null}const t=atob(e),s="boodschappenlijst_secure_v2_2024";let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t.charCodeAt(e)^s.charCodeAt(e%s.length));const a=r.split(":",2);if(2!==a.length)try{return JSON.parse(r)}catch{return null}const[,i]=a;try{return JSON.parse(i)}catch{return null}}catch(t){return null}}async setItem(e,t,s={}){const r=Tt+e,a=Lt+e,i=Rt+e,n=this.encrypt(t),o={value:n,metadata:{timestamp:Date.now(),version:"2.0",userAgent:navigator.userAgent,persistent:!1!==s.persistent}};this.memoryCache.set(e,t);const l=[];if(this.availableStorage.localStorage)try{localStorage.setItem(r,JSON.stringify(o)),localStorage.setItem(a,JSON.stringify(o))}catch(c){}if(this.availableStorage.sessionStorage)try{sessionStorage.setItem(i,JSON.stringify(o))}catch(c){}return this.availableStorage.indexedDB&&this.db&&l.push(this.setIndexedDBItem(e,o)),s.critical&&this.setCookie(e,n,365),await Promise.allSettled(l),!0}async setIndexedDBItem(e,t){return new Promise((s,r)=>{const a=this.db.transaction(["userData"],"readwrite").objectStore("userData").put({key:e,data:t});a.onsuccess=()=>s(),a.onerror=()=>r(a.error)})}async getItem(e){if(this.memoryCache.has(e))return this.memoryCache.get(e);const t=Tt+e,s=Lt+e,r=Rt+e;let a=null;if(this.availableStorage.localStorage)try{const s=localStorage.getItem(t);if(s)try{a=JSON.parse(s)}catch(i){try{const t=this.decrypt(s);if(null!==t)return this.memoryCache.set(e,t),t}catch(n){}}}catch(o){}if(!a&&this.availableStorage.localStorage)try{const t=localStorage.getItem(s);if(t)try{a=JSON.parse(t)}catch(i){try{const s=this.decrypt(t);if(null!==s)return this.memoryCache.set(e,s),s}catch(n){}}}catch(o){}if(!a&&this.availableStorage.sessionStorage)try{const t=sessionStorage.getItem(r);if(t)try{a=JSON.parse(t)}catch(i){try{const s=this.decrypt(t);if(null!==s)return this.memoryCache.set(e,s),s}catch(n){}}}catch(o){}if(!a&&this.availableStorage.indexedDB&&this.db)try{a=await this.getIndexedDBItem(e)}catch(o){}if(!a){const t=this.getCookie(e);if(t)try{const s=this.decrypt(t);if(null!==s)return this.memoryCache.set(e,s),s}catch(n){}}if(a)try{const t=this.decrypt(a.value);if(null!==t)return this.memoryCache.set(e,t),t}catch(n){}return null}async getIndexedDBItem(e){return new Promise((t,s)=>{const r=this.db.transaction(["userData"],"readonly").objectStore("userData").get(e);r.onsuccess=()=>{const e=r.result;t(e?e.data:null)},r.onerror=()=>s(r.error)})}setCookie(e,t,s){try{const r=new Date;r.setTime(r.getTime()+24*s*60*60*1e3);const a=`${Tt}${e}=${encodeURIComponent(t)}; expires=${r.toUTCString()}; path=/; SameSite=Strict`;document.cookie=a}catch(r){}}getCookie(e){try{const t=`${Tt}${e}=`,s=decodeURIComponent(document.cookie).split(";");for(let e of s)if(e=e.trim(),0===e.indexOf(t))return e.substring(t.length)}catch(t){}return null}async removeItem(e){const t=Tt+e,s=Lt+e,r=Rt+e;if(this.memoryCache.delete(e),this.availableStorage.localStorage)try{localStorage.removeItem(t),localStorage.removeItem(s)}catch(a){}if(this.availableStorage.sessionStorage)try{sessionStorage.removeItem(r)}catch(a){}if(this.availableStorage.indexedDB&&this.db)try{await this.removeIndexedDBItem(e)}catch(a){}this.setCookie(e,"",-1)}async removeIndexedDBItem(e){return new Promise((t,s)=>{const r=this.db.transaction(["userData"],"readwrite").objectStore("userData").delete(e);r.onsuccess=()=>t(),r.onerror=()=>s(r.error)})}async syncStorage(){for(const[e,t]of this.memoryCache.entries())await this.setItem(e,t,{critical:!0})}async getStorageHealth(){let e=0,t=0;if(this.availableStorage.localStorage)try{for(let s=0;s<localStorage.length;s++){const r=localStorage.key(s);if(r&&r.startsWith(Tt)){const s=localStorage.getItem(r);s&&(e+=2*s.length,t++)}}}catch(a){}if(this.availableStorage.sessionStorage)try{for(let s=0;s<sessionStorage.length;s++){const r=sessionStorage.key(s);if(r&&r.startsWith(Rt)){const s=sessionStorage.getItem(r);s&&(e+=2*s.length,t++)}}}catch(a){}t+=this.memoryCache.size;let s="healthy";const r=Object.values(this.availableStorage).filter(Boolean).length;return 0===r?s="error":r<3&&(s="warning"),{available:this.availableStorage,memoryCache:this.memoryCache.size,timestamp:Date.now(),status:s,lastCheck:Date.now(),totalSize:e,items:t}}async clearCorruptedData(){const e=["unified_color_theme","default_theme_preference","user_state","shopping_lists","user_name","device_uid"];for(const s of e)try{await this.removeItem(s)}catch(t){}if(this.availableStorage.localStorage)try{const e=Object.keys(localStorage);for(const t of e)(t.startsWith(Tt)||t.startsWith(Lt))&&localStorage.removeItem(t)}catch(t){}if(this.availableStorage.sessionStorage)try{const e=Object.keys(sessionStorage);for(const t of e)t.startsWith(Rt)&&sessionStorage.removeItem(t)}catch(t){}if(this.availableStorage.indexedDB&&this.db)try{const e=this.db.transaction(["userData"],"readwrite"),t=e.objectStore("userData").clear();t.onsuccess=()=>{},t.onerror=()=>{}}catch(t){}try{const e=document.cookie.split(";");for(const t of e){const e=t.indexOf("="),s=e>-1?t.substr(0,e).trim():t.trim();s.startsWith(Tt)&&(document.cookie=`${s}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/`)}}catch(t){}this.memoryCache.clear()}};Dt.initializeStorage().catch(console.error),"undefined"!=typeof window&&(document.addEventListener("visibilitychange",()=>{document.hidden||Dt.syncStorage().catch(console.error)}),window.addEventListener("focus",()=>{Dt.syncStorage().catch(console.error)}),window.addEventListener("beforeunload",()=>{Dt.syncStorage().catch(console.error)}),setInterval(()=>{Dt.syncStorage().catch(console.error)},3e4),window.clearAllStorage=async()=>{try{localStorage.clear(),sessionStorage.clear(),"indexedDB"in window&&indexedDB.deleteDatabase("BoodschappenlijstDB").catch(console.warn),document.cookie.split(";").forEach(e=>{const t=e.indexOf("="),s=t>-1?e.substring(0,t).trim():e.trim();document.cookie=`${s}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/`})}catch(e){}});const At="user_name",Ot="user_id",Mt="user_session",Pt="user_preferences",Ut="user_activity";const zt=new class{constructor(){this.userCache=new Map,this.sessionId=this.generateSessionId(),this.initializeUser(),this.setupEventListeners()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async initializeUser(){try{await this.loadUserData(),await this.updateSession(),await this.logActivity("app_start")}catch(e){}}async loadUserData(){try{const e=await Dt.getItem(At),t=await Dt.getItem(Ot),s=await Dt.getItem(Pt);if(e&&this.userCache.set("name",e),t)this.userCache.set("id",t);else{const e=this.generateUserId();this.userCache.set("id",e),await Dt.setItem(Ot,e,{critical:!0})}if(s)this.userCache.set("preferences",s);else{const e={theme:"auto",language:"nl",notifications:!0,autoSync:!0};this.userCache.set("preferences",e),await Dt.setItem(Pt,e)}}catch(e){}}generateUserId(){return`user_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async updateSession(){const e={sessionId:this.sessionId,startTime:Date.now(),userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screenResolution:`${screen.width}x${screen.height}`,lastActivity:Date.now()};await Dt.setItem(Mt,e),this.userCache.set("session",e)}async logActivity(e,t={}){try{const s=await Dt.getItem(Ut)||[],r={timestamp:Date.now(),sessionId:this.sessionId,activity:e,data:t,url:window.location.href,userAgent:navigator.userAgent};s.push(r),s.length>100&&s.splice(0,s.length-100),await Dt.setItem(Ut,s)}catch(s){}}setupEventListeners(){document.addEventListener("visibilitychange",async()=>{document.hidden?(await this.logActivity("page_hidden"),await this.syncUserData()):(await this.logActivity("page_visible"),await this.loadUserData())}),window.addEventListener("focus",async()=>{await this.logActivity("window_focus"),await this.loadUserData()}),window.addEventListener("blur",async()=>{await this.logActivity("window_blur"),await this.syncUserData()}),window.addEventListener("beforeunload",async()=>{await this.logActivity("page_unload"),await this.syncUserData()}),setInterval(async()=>{await this.syncUserData()},1e4)}async syncUserData(){try{for(const[e,t]of this.userCache.entries())"name"===e?await Dt.setItem(At,t,{critical:!0}):"id"===e?await Dt.setItem(Ot,t,{critical:!0}):"preferences"===e?await Dt.setItem(Pt,t):"session"===e&&await Dt.setItem(Mt,t);await this.updateLastActivity()}catch(e){}}async updateLastActivity(){const e=this.userCache.get("session")||{};e.lastActivity=Date.now(),this.userCache.set("session",e),await Dt.setItem(Mt,e)}async getUserName(){let e=this.userCache.get("name");return e||(e=await Dt.getItem(At),e&&this.userCache.set("name",e)),e}async setUserName(e){const t=this.validateUserName(e);if(!t.valid)throw new Error(t.error);const s=t.value;return this.userCache.set("name",s),await Dt.setItem(At,s,{critical:!0}),await this.logActivity("user_name_set",{name:s}),await this.syncUserData(),!0}async hasUserName(){const e=await this.getUserName();return e&&e.trim().length>0}async clearUserName(){this.userCache.delete("name"),await Dt.removeItem(At),await this.logActivity("user_name_cleared")}async getUserId(){let e=this.userCache.get("id");return e||(e=await Dt.getItem(Ot),e?this.userCache.set("id",e):(e=this.generateUserId(),this.userCache.set("id",e),await Dt.setItem(Ot,e,{critical:!0}))),e}async getUserInfo(){const e=await this.getUserName(),t=await this.getUserId(),s=this.userCache.get("preferences")||{},r=this.userCache.get("session")||{};return{name:e||null,id:t,hasName:e&&e.trim().length>0,preferences:s,session:r,isActive:!0}}async getUserPreferences(){let e=this.userCache.get("preferences");return e||(e=await Dt.getItem(Pt)||{theme:"auto",language:"nl",notifications:!0,autoSync:!0},this.userCache.set("preferences",e)),e}async setUserPreference(e,t){const s=await this.getUserPreferences();s[e]=t,s.lastUpdated=Date.now(),this.userCache.set("preferences",s),await Dt.setItem(Pt,s),await this.logActivity("preference_updated",{key:e,value:t})}async getUserActivity(){return await Dt.getItem(Ut)||[]}async getStorageHealth(){return{...Dt.getStorageHealth(),userDataSize:this.userCache.size,lastSync:Date.now(),sessionId:this.sessionId}}validateUserName(e){if(!e||"string"!=typeof e)return{valid:!1,error:"Naam is verplicht"};const t=e.trim();if(0===t.length)return{valid:!1,error:"Naam mag niet leeg zijn"};if(t.length<2)return{valid:!1,error:"Naam moet minimaal 2 karakters lang zijn"};if(t.length>50)return{valid:!1,error:"Naam mag maximaal 50 karakters lang zijn"};if(!/^[a-zA-Z0-9\s\-_.àáâãäåæçèéêëìíîïðñòóôõöøùúûüýþÿĀāĂăĄąĆćĈĉĊċČčĎďĐđĒēĔĕĖėĘęĚěĜĝĞğĠġĢģĤĥĦħĨĩĪīĬĭĮįİıĲĳĴĵĶķĸĹĺĻļĽľĿŀŁłŃńŅņŇňŉŊŋŌōŎŏŐőŒœŔŕŖŗŘřŚśŜŝŞşŠšŢţŤťŦŧŨũŪūŬŭŮůŰűŲųŴŵŶŷŸŹźŻżŽž]+$/i.test(t))return{valid:!1,error:"Naam bevat ongeldige karakters"};return["admin","system","null","undefined","anonymous"].some(e=>t.toLowerCase().includes(e))?{valid:!1,error:"Deze naam is niet toegestaan"}:{valid:!0,value:t}}async recoverUserData(){try{const e={},t=await this.getStorageHealth();for(const s of Object.keys(t.available))t.available[s];return e}catch(e){return null}}async exportUserData(){const e=await this.getUserInfo(),t=await this.getUserPreferences(),s=await this.getUserActivity(),r=await this.getStorageHealth();return{userData:e,preferences:t,activity:s.slice(-10),storageHealth:r,exportTimestamp:Date.now(),version:"2.0"}}async importUserData(e){try{return e.userData&&e.userData.name&&await this.setUserName(e.userData.name),e.preferences&&(this.userCache.set("preferences",e.preferences),await Dt.setItem(Pt,e.preferences)),await this.logActivity("data_imported",{importTimestamp:Date.now(),originalExportTimestamp:e.exportTimestamp}),!0}catch(t){return!1}}},qt="app_state",Bt="shopping_lists",Ft="theme_state",Vt="ui_state";const $t=new class{constructor(){this.state=new Map,this.subscribers=new Map,this.syncQueue=[],this.isSyncing=!1,this.lastSyncTime=0,this.syncInterval=5e3,this.initialize()}async initialize(){try{await this.loadState(),this.setupEventListeners(),this.startPeriodicSync()}catch(e){}}async loadState(){try{const e=await Dt.getItem(qt)||{},t=await Dt.getItem(Bt)||[],s=await Dt.getItem(Ft)||{theme:"light"},r=await Dt.getItem(Vt)||{};this.state.set("app",e),this.state.set("lists",t),this.state.set("theme",s),this.state.set("ui",r);const a=await zt.getUserInfo();this.state.set("user",a)}catch(e){this.initializeDefaultState()}}initializeDefaultState(){this.state.set("app",{version:"2.0",initialized:!0,lastAccess:Date.now()}),this.state.set("lists",[]),this.state.set("theme",{theme:"light"}),this.state.set("ui",{selectedList:null,showSettings:!1,showShare:!1,showScanner:!1}),this.state.set("user",{name:null,hasName:!1,isActive:!1})}setupEventListeners(){document.addEventListener("visibilitychange",async()=>{document.hidden?await this.syncState("page_hidden"):(await this.loadState(),this.notifySubscribers("state_reloaded"))}),window.addEventListener("focus",async()=>{await this.loadState(),this.notifySubscribers("state_reloaded")}),window.addEventListener("blur",async()=>{await this.syncState("window_blur")}),window.addEventListener("beforeunload",async()=>{await this.syncState("page_unload")}),window.addEventListener("storage",e=>{e.key&&e.key.includes("boodschappenlijst_v2_")&&this.loadState().then(()=>{this.notifySubscribers("storage_changed")})})}startPeriodicSync(){setInterval(async()=>{!this.isSyncing&&Date.now()-this.lastSyncTime>this.syncInterval&&await this.syncState("periodic")},this.syncInterval)}subscribe(e,t){return this.subscribers.has(e)||this.subscribers.set(e,new Set),this.subscribers.get(e).add(t),()=>{const s=this.subscribers.get(e);s&&s.delete(t)}}notifySubscribers(e,t=null){const s=this.subscribers.get(e);s&&s.forEach(e=>{try{e(t)}catch(s){}});const r=this.subscribers.get("*");r&&r.forEach(s=>{try{s({key:e,data:t})}catch(r){}})}getState(e){return this.state.get(e)}async setState(e,t,s={}){const r=this.state.get(e);return this.state.set(e,t),s.immediate?await this.persistState(e,t):this.syncQueue.push({key:e,value:t,timestamp:Date.now()}),this.notifySubscribers(e,{oldValue:r,newValue:t}),!0}async updateState(e,t,s={}){const r=this.state.get(e),a="function"==typeof t?t(r):t;return await this.setState(e,a,s)}async persistState(e,t){try{let s,r=!1;switch(e){case"lists":s=Bt,r=!0;break;case"theme":s=Ft;break;case"ui":s=Vt;break;case"user":return;default:s=qt}await Dt.setItem(s,t,{critical:r})}catch(s){}}async syncState(e="manual"){if(!this.isSyncing){this.isSyncing=!0;try{const e=[...this.syncQueue];this.syncQueue=[];for(const{key:t,value:s}of e)await this.persistState(t,s);for(const[t,s]of this.state.entries())await this.persistState(t,s);this.lastSyncTime=Date.now()}catch(t){this.syncQueue.unshift(...this.syncQueue)}finally{this.isSyncing=!1}}}async addList(e){const t=this.getState("lists")||[];if(e.name&&e.creatorId){const s=e.name.toLowerCase().trim(),r=t.find(t=>t.name.toLowerCase().trim()===s&&t.creatorId===e.creatorId);if(r)return r}const s={...e,id:e.id||`list_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:Date.now(),updatedAt:Date.now(),isCreator:void 0===e.isCreator||e.isCreator,sharedWith:e.sharedWith||[]},r=[...t,s];return await this.setState("lists",r,{immediate:!0}),s}async updateList(e,t){const s=(this.getState("lists")||[]).map(s=>s.id===e?{...s,...t,updatedAt:Date.now()}:s);return await this.setState("lists",s,{immediate:!0}),s.find(t=>t.id===e)}async removeList(e){const t=(this.getState("lists")||[]).filter(t=>t.id!==e);return await this.setState("lists",t,{immediate:!0}),!0}async getList(e){return(this.getState("lists")||[]).find(t=>t.id===e)}async setTheme(e){const t={theme:e,updatedAt:Date.now()};return await this.setState("theme",t,{immediate:!0}),document.documentElement.setAttribute("data-theme",e),e}getTheme(){return(this.getState("theme")||{theme:"light"}).theme}async setUIState(e,t){const s={...this.getState("ui")||{},[e]:t};return await this.setState("ui",s),t}getUIState(e){return(this.getState("ui")||{})[e]}async createBackup(){return{timestamp:Date.now(),version:"2.0",state:Object.fromEntries(this.state.entries()),userInfo:await zt.getUserInfo(),storageHealth:await Dt.getStorageHealth(),note:"This is a legacy backup. Use Firebase export for complete shopping lists."}}async restoreFromBackup(e){if(e.lists&&Array.isArray(e.lists))try{const{firebaseBackup:t}=await ye(async()=>{const{firebaseBackup:e}=await import("./firebaseBackup-DNKn96ET.js");return{firebaseBackup:e}},__vite__mapDeps([7,3,1,2]));return await t.importFirebaseData(e)}catch(t){return!1}try{if(!e||!e.state)throw new Error("Invalid backup data");for(const[t,s]of Object.entries(e.state))this.state.set(t,s),await this.persistState(t,s);return e.userInfo&&e.userInfo.name&&await zt.setUserName(e.userInfo.name),this.notifySubscribers("state_restored",e),!0}catch(t){return!1}}async getStateInfo(){const e=await zt.getUserInfo(),t=await Dt.getStorageHealth();return{state:Object.fromEntries(this.state.entries()),userInfo:e,storageHealth:t,syncQueue:this.syncQueue.length,lastSyncTime:this.lastSyncTime,isSyncing:this.isSyncing,subscribers:Array.from(this.subscribers.keys())}}async resetState(){return this.state.clear(),this.syncQueue=[],await Dt.removeItem(qt),await Dt.removeItem(Bt),await Dt.removeItem(Ft),await Dt.removeItem(Vt),await zt.clearUserName(),this.initializeDefaultState(),this.notifySubscribers("state_reset"),!0}};function Ht(){const[t,s]=e.useState(!1),[r,a]=e.useState(!1),[i,n]=e.useState(null),o=e.useCallback(async()=>{try{s(!0),n(null);const e=await $t.createBackup(),t=JSON.stringify(e,null,2),r=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(r),i=document.createElement("a");return i.href=a,i.download=`boodschappenlijst-backup-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a),e}catch(e){throw n(e),e}finally{s(!1)}},[]),l=e.useCallback(async e=>{try{a(!0),n(null);const t=await $t.restoreFromBackup(e);return t&&window.location.reload(),t}catch(t){throw n(t),t}finally{a(!1)}},[]),c=e.useCallback(async e=>{try{const t=await e.text(),s=JSON.parse(t);return await l(s)}catch(t){throw n(t),t}},[l]);return{createBackup:o,restoreFromBackup:l,restoreFromFile:c,isCreatingBackup:t,isRestoring:r,error:i}}function Wt(){const[t,s]=e.useState(null),[r,a]=e.useState(!0);e.useEffect(()=>{let e=!1;const t=async()=>{try{const t=await $t.getStateInfo();e||(s(t),a(!1))}catch(t){e||a(!1)}};t();const r=setInterval(t,3e4);return()=>{e=!0,clearInterval(r)}},[]);return{healthInfo:t,refreshHealthInfo:e.useCallback(async()=>{try{a(!0);const e=await $t.getStateInfo();s(e)}catch(e){}finally{a(!1)}},[]),isLoading:r}}const Gt=[{key:"ocean-breeze",name:"Ocean Breeze",description:"Calming ocean-inspired blues and teals",colors:{primary:"52 152 219",secondary:"26 188 156",accent:"155 89 182",background:"44 62 80",surface:"52 73 94",text:"236 240 241",textSecondary:"189 195 199",success:"46 204 113",warning:"241 196 15",error:"231 76 60",info:"52 152 219"},lightMode:{primary:"41 128 185",secondary:"22 160 133",accent:"142 68 173",background:"236 240 241",surface:"255 255 255",text:"44 62 80",textSecondary:"127 140 141"}},{key:"sunset-glow",name:"Sunset Glow",description:"Warm sunset colors with orange and pink tones",colors:{primary:"255 107 107",secondary:"255 159 67",accent:"255 107 129",background:"47 54 64",surface:"64 75 88",text:"255 255 255",textSecondary:"223 230 233",success:"85 239 196",warning:"253 203 110",error:"255 107 107",info:"116 185 255"},lightMode:{primary:"214 48 49",secondary:"230 126 34",accent:"253 121 168",background:"253 251 251",surface:"255 255 255",text:"47 54 64",textSecondary:"99 110 114"}},{key:"forest-mint",name:"Forest Mint",description:"Fresh forest greens with mint accents",colors:{primary:"85 239 196",secondary:"0 184 148",accent:"129 236 236",background:"45 52 54",surface:"99 110 114",text:"253 251 251",textSecondary:"223 230 233",success:"0 184 148",warning:"253 203 110",error:"255 107 107",info:"116 185 255"},lightMode:{primary:"0 150 136",secondary:"76 175 80",accent:"0 188 212",background:"245 245 245",surface:"255 255 255",text:"33 37 41",textSecondary:"108 117 125"}},{key:"lavender-dream",name:"Lavender Dream",description:"Soft purples and pinks with dreamy pastels",colors:{primary:"162 155 254",secondary:"253 121 168",accent:"255 118 117",background:"45 52 54",surface:"99 110 114",text:"253 251 251",textSecondary:"223 230 233",success:"85 239 196",warning:"253 203 110",error:"255 118 117",info:"116 185 255"},lightMode:{primary:"124 77 255",secondary:"233 30 99",accent:"255 64 129",background:"250 250 250",surface:"255 255 255",text:"33 33 33",textSecondary:"117 117 117"}},{key:"golden-hour",name:"Golden Hour",description:"Warm golden yellows and rich browns",colors:{primary:"255 193 7",secondary:"255 152 0",accent:"255 87 34",background:"62 39 35",surface:"93 64 55",text:"255 248 225",textSecondary:"255 224 178",success:"139 195 74",warning:"255 193 7",error:"244 67 54",info:"33 150 243"},lightMode:{primary:"255 143 0",secondary:"230 81 0",accent:"191 54 12",background:"255 253 245",surface:"255 255 255",text:"62 39 35",textSecondary:"121 85 72"}},{key:"midnight-blue",name:"Midnight Blue",description:"Deep blues with silver accents for elegance",colors:{primary:"63 81 181",secondary:"103 58 183",accent:"156 39 176",background:"21 32 43",surface:"32 47 60",text:"255 255 255",textSecondary:"176 190 197",success:"76 175 80",warning:"255 193 7",error:"244 67 54",info:"33 150 243"},lightMode:{primary:"48 63 159",secondary:"81 45 168",accent:"123 31 162",background:"245 245 245",surface:"255 255 255",text:"33 33 33",textSecondary:"97 97 97"}},{key:"cherry-blossom",name:"Cherry Blossom",description:"Soft pinks and whites inspired by spring",colors:{primary:"255 182 193",secondary:"255 105 180",accent:"219 112 147",background:"47 47 47",surface:"64 64 64",text:"255 255 255",textSecondary:"192 192 192",success:"144 238 144",warning:"255 215 0",error:"255 99 71",info:"135 206 235"},lightMode:{primary:"199 21 133",secondary:"255 20 147",accent:"186 85 211",background:"255 240 245",surface:"255 255 255",text:"47 47 47",textSecondary:"105 105 105"}},{key:"arctic-frost",name:"Arctic Frost",description:"Cool whites and icy blues for a clean look",colors:{primary:"70 130 180",secondary:"95 158 160",accent:"176 196 222",background:"25 25 25",surface:"45 45 45",text:"248 248 255",textSecondary:"220 220 220",success:"32 178 170",warning:"255 215 0",error:"220 20 60",info:"30 144 255"},lightMode:{primary:"25 25 112",secondary:"72 61 139",accent:"106 90 205",background:"248 248 255",surface:"255 255 255",text:"25 25 25",textSecondary:"105 105 105"}}],Jt="unified_color_theme",Qt="default_theme_preference",Kt={hexToRgb:e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},rgbToHex:(e,t,s)=>"#"+((1<<24)+(e<<16)+(t<<8)+s).toString(16).slice(1),getLuminance:(e,t,s)=>{const[r,a,i]=[e,t,s].map(e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*r+.7152*a+.0722*i},getContrastRatio:(e,t)=>{const s=Kt.getLuminance(e.r,e.g,e.b),r=Kt.getLuminance(t.r,t.g,t.b);return(Math.max(s,r)+.05)/(Math.min(s,r)+.05)},meetsAccessibilityStandards:(e,t)=>{const s=Kt.getContrastRatio(e,t);return{aa:s>=4.5,aaa:s>=7,contrast:s.toFixed(2)}},generateColorVariations:(e,t="light")=>{if(!Kt.hexToRgb(e))return null;const s={};return"light"===t?(s.primary=e,s.primaryHover=Kt.adjustBrightness(e,-10),s.primaryActive=Kt.adjustBrightness(e,-20),s.primaryLight=Kt.adjustBrightness(e,20),s.primaryDark=Kt.adjustBrightness(e,-30)):(s.primary=e,s.primaryHover=Kt.adjustBrightness(e,10),s.primaryActive=Kt.adjustBrightness(e,20),s.primaryLight=Kt.adjustBrightness(e,30),s.primaryDark=Kt.adjustBrightness(e,-20)),s},adjustBrightness:(e,t)=>{const s=Kt.hexToRgb(e);if(!s)return e;const r=e=>{const s=Math.round(e+e*t/100);return Math.max(0,Math.min(255,s))};return Kt.rgbToHex(r(s.r),r(s.g),r(s.b))},getComplementaryColor:e=>{const t=Kt.hexToRgb(e);return t?Kt.rgbToHex(255-t.r,255-t.g,255-t.b):e},getAnalogousColors:e=>{const t=Kt.hexToRgb(e);if(!t)return[e,e];const s=Kt.rgbToHsl(t.r,t.g,t.b),r=Kt.hslToRgb((s.h+30)%360,s.s,s.l),a=Kt.hslToRgb((s.h-30+360)%360,s.s,s.l);return[Kt.rgbToHex(r.r,r.g,r.b),Kt.rgbToHex(a.r,a.g,a.b)]},rgbToHsl:(e,t,s)=>{e/=255,t/=255,s/=255;const r=Math.max(e,t,s),a=Math.min(e,t,s);let i,n,o=(r+a)/2;if(r===a)i=n=0;else{const l=r-a;switch(n=o>.5?l/(2-r-a):l/(r+a),r){case e:i=(t-s)/l+(t<s?6:0);break;case t:i=(s-e)/l+2;break;case s:i=(e-t)/l+4}i/=6}return{h:360*i,s:100*n,l:100*o}},hslToRgb:(e,t,s)=>{e/=360,s/=100;const r=(e,t,s)=>(s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e);let a,i,n;if(0===(t/=100))a=i=n=s;else{const o=s<.5?s*(1+t):s+t-s*t,l=2*s-o;a=r(l,o,e+1/3),i=r(l,o,e),n=r(l,o,e-1/3)}return{r:Math.round(255*a),g:Math.round(255*i),b:Math.round(255*n)}}};const Zt=new class{constructor(){this.currentTheme=null,this.subscribers=new Set,this.isInitialized=!1,this.initializationPromise=null}async initialize(){return this.isInitialized?this.currentTheme:(this.initializationPromise||(this.initializationPromise=this._doInitialize()),this.initializationPromise)}async _doInitialize(){try{await Dt.initializeStorage();let t=await Dt.getItem(Jt);const s=await Dt.getItem(Qt)||"light";try{localStorage.getItem("boodschappenlijst_v2_unified_color_theme"),localStorage.getItem("boodschappenlijst_backup_unified_color_theme")}catch(e){}if(!t||!t.palette)try{const e=localStorage.getItem("simple_theme_backup");if(e){const r=JSON.parse(e);if(r.name&&r.paletteKey){const e=this.getAvailablePalettes().find(e=>e.key===r.paletteKey);e&&(t={name:r.name,palette:e,mode:r.mode||s,customColors:{},accessibility:{enforceStandards:!0,minimumContrast:4.5},createdAt:r.timestamp||Date.now(),lastModified:r.timestamp||Date.now()})}}}catch(e){}if(t&&t.palette)this.currentTheme={...t,mode:t.mode||s};else{const e=this.getDefaultPalette();this.currentTheme={name:"Gruvbox",palette:e,mode:s,customColors:{},accessibility:{enforceStandards:!0,minimumContrast:4.5},createdAt:Date.now(),lastModified:Date.now()},await this.saveTheme()}return this.isInitialized=!0,this.applyTheme(),this.currentTheme}catch(t){return this.setDefaultTheme(),this.isInitialized=!0,this.currentTheme}}getDefaultPalette(){return Gt&&Array.isArray(Gt)&&Gt.length>0?Gt[0]:this.getFallbackThemes()[0]}setDefaultTheme(){const e=this.getDefaultPalette();this.currentTheme={name:"Gruvbox",palette:e,mode:"light",customColors:{},accessibility:{enforceStandards:!0,minimumContrast:4.5},createdAt:Date.now(),lastModified:Date.now()},this.applyTheme()}subscribe(e){return this.subscribers.add(e),()=>this.subscribers.delete(e)}notifySubscribers(){this.subscribers.forEach(e=>{try{e(this.currentTheme)}catch(t){}})}getCurrentTheme(){return this.isInitialized?{...this.currentTheme}:{name:"Loading...",mode:"light",palette:this.getDefaultPalette(),customColors:{},accessibility:{enforceStandards:!0,minimumContrast:4.5}}}async setColorPalette(e){await this.initialize();let t=null;if(Gt&&Array.isArray(Gt)&&(t=Gt.find(t=>t.key===e)),!t){t=this.getFallbackThemes().find(t=>t.key===e)}t&&(this.currentTheme={...this.currentTheme,name:t.name,palette:t,lastModified:Date.now()},await this.saveTheme(),this.applyTheme(),this.notifySubscribers())}async toggleMode(){const e="light"===this.currentTheme.mode?"dark":"light";await this.setMode(e)}async setMode(e){if(await this.initialize(),"light"!==e&&"dark"!==e)throw new Error('Mode must be "light" or "dark"');this.currentTheme={...this.currentTheme,mode:e,lastModified:Date.now()},await this.saveTheme(),await Dt.setItem(Qt,e,{critical:!0}),this.applyTheme(),this.notifySubscribers()}async setCustomColor(e,t){this.validateColorAccessibility(t).valid&&(this.currentTheme={...this.currentTheme,customColors:{...this.currentTheme.customColors,[e]:t},lastModified:Date.now()},await this.saveTheme(),this.applyTheme(),this.notifySubscribers())}validateColorAccessibility(e){const t=Kt.hexToRgb(e);if(!t)return{valid:!1,reason:"Invalid color format"};const s="light"===this.currentTheme.mode?{r:251,g:241,b:199}:{r:40,g:40,b:40},r=Kt.meetsAccessibilityStandards(t,s);return r.contrast<this.currentTheme.accessibility.minimumContrast?{valid:!1,reason:`Contrast ratio ${r.contrast} is below minimum ${this.currentTheme.accessibility.minimumContrast}`,contrast:r.contrast}:{valid:!0,contrast:r.contrast}}getEffectiveColor(e){const t="light"===this.currentTheme.mode&&this.currentTheme.palette.lightMode?this.currentTheme.palette.lightMode:this.currentTheme.palette.colors;return this.currentTheme.customColors[e]||t[e]||"107 114 128"}applyTheme(){const e=document.documentElement,t=this.currentTheme.mode;e.setAttribute("data-theme",t);const s="light"===t&&this.currentTheme.palette.lightMode?this.currentTheme.palette.lightMode:this.currentTheme.palette.colors;Object.keys(s).forEach(t=>{const r=this.currentTheme.customColors[t]||s[t];r&&e.style.setProperty(`--color-${t}`,r)});const r=s.background||"40 40 40",a=s.text||"235 219 178",i=s.surface||"60 56 54",n=s.textSecondary||"168 153 132";e.style.setProperty("--bg-color",r),e.style.setProperty("--text-color",a),e.style.setProperty("--card-bg",i),e.style.setProperty("--card-text",a),e.style.setProperty("--border-color",n)}async saveTheme(){try{await Dt.setItem(Jt,this.currentTheme,{critical:!0});try{const e={name:this.currentTheme.name,mode:this.currentTheme.mode,paletteKey:this.currentTheme.palette?.key,timestamp:Date.now()};localStorage.setItem("simple_theme_backup",JSON.stringify(e))}catch(e){}await Dt.getItem(Jt);try{localStorage.getItem("boodschappenlijst_v2_unified_color_theme")}catch(e){}}catch(t){}}exportTheme(){return{...this.currentTheme,exportedAt:Date.now(),version:"1.0"}}async importTheme(e){try{if(!e.palette||!e.name)throw new Error("Invalid theme data");return this.currentTheme={...e,lastModified:Date.now(),importedAt:Date.now()},await this.saveTheme(),this.applyTheme(),this.notifySubscribers(),!0}catch(t){return!1}}async resetTheme(){this.setDefaultTheme(),await this.saveTheme(),this.notifySubscribers()}getAvailablePalettes(){return Gt&&Array.isArray(Gt)&&Gt.length>0?Gt.map(e=>({key:e.key,name:e.name,description:e.description,colors:e.colors,lightMode:e.lightMode})):this.getFallbackThemes()}getFallbackThemes(){return[{key:"gruvbox",name:"Gruvbox",description:"Retro groove color scheme",colors:{primary:"254 128 25",secondary:"184 187 38",accent:"251 73 52",background:"40 40 40",surface:"60 56 54",text:"235 219 178",textSecondary:"168 153 132",success:"184 187 38",warning:"250 189 47",error:"251 73 52",info:"131 165 152"},lightMode:{primary:"175 58 3",secondary:"121 116 14",accent:"157 0 6",background:"251 241 199",surface:"242 229 188",text:"60 56 54",textSecondary:"102 92 84"}},{key:"solarized",name:"Solarized",description:"Precision colors for machines and people",colors:{primary:"38 139 210",secondary:"133 153 0",accent:"220 50 47",background:"0 43 54",surface:"7 54 66",text:"131 148 150",textSecondary:"101 123 131",success:"133 153 0",warning:"181 137 0",error:"220 50 47",info:"38 139 210"},lightMode:{primary:"38 139 210",secondary:"133 153 0",accent:"220 50 47",background:"253 246 227",surface:"238 232 213",text:"101 123 131",textSecondary:"131 148 150"}},{key:"dracula",name:"Dracula",description:"Dark theme for the cool kids",colors:{primary:"189 147 249",secondary:"80 250 123",accent:"255 85 85",background:"40 42 54",surface:"68 71 90",text:"248 248 242",textSecondary:"139 233 253",success:"80 250 123",warning:"241 250 140",error:"255 85 85",info:"139 233 253"},lightMode:{primary:"189 147 249",secondary:"80 250 123",accent:"255 85 85",background:"248 248 242",surface:"255 255 255",text:"40 42 54",textSecondary:"68 71 90"}},{key:"nord",name:"Nord",description:"Arctic, north-bluish color palette",colors:{primary:"129 161 193",secondary:"163 190 140",accent:"191 97 106",background:"46 52 64",surface:"59 66 82",text:"216 222 233",textSecondary:"129 161 193",success:"163 190 140",warning:"235 203 139",error:"191 97 106",info:"136 192 208"},lightMode:{primary:"94 129 172",secondary:"136 192 208",accent:"191 97 106",background:"229 233 240",surface:"236 239 244",text:"46 52 64",textSecondary:"76 86 106"}},{key:"monokai",name:"Monokai Pro",description:"Professional dark theme with vibrant colors",colors:{primary:"120 220 232",secondary:"169 220 118",accent:"255 97 136",background:"45 42 46",surface:"60 56 61",text:"252 252 250",textSecondary:"120 220 232",success:"169 220 118",warning:"255 214 102",error:"255 97 136",info:"171 157 242"},lightMode:{primary:"120 220 232",secondary:"169 220 118",accent:"255 97 136",background:"252 252 250",surface:"255 255 255",text:"45 42 46",textSecondary:"60 56 61"}},{key:"onedark",name:"One Dark",description:"Atom One Dark theme for everyone",colors:{primary:"97 175 239",secondary:"152 195 121",accent:"224 108 117",background:"40 44 52",surface:"53 59 69",text:"171 178 191",textSecondary:"171 178 191",success:"152 195 121",warning:"229 192 123",error:"224 108 117",info:"97 175 239"},lightMode:{primary:"97 175 239",secondary:"152 195 121",accent:"224 108 117",background:"250 251 252",surface:"255 255 255",text:"40 44 52",textSecondary:"92 99 112"}},{key:"tokyonight",name:"Tokyo Night",description:"Dark theme inspired by Tokyo at night",colors:{primary:"122 162 247",secondary:"158 206 106",accent:"247 118 142",background:"26 27 38",surface:"36 40 59",text:"192 202 245",textSecondary:"169 177 214",success:"158 206 106",warning:"255 203 107",error:"247 118 142",info:"122 162 247"},lightMode:{primary:"122 162 247",secondary:"158 206 106",accent:"247 118 142",background:"223 225 239",surface:"241 243 255",text:"26 27 38",textSecondary:"76 79 105"}}]}getThemeStats(){return{name:this.currentTheme.name,mode:this.currentTheme.mode,customColors:Object.keys(this.currentTheme.customColors).length,createdAt:this.currentTheme.createdAt,lastModified:this.currentTheme.lastModified,accessibility:this.currentTheme.accessibility}}},Yt=e.createContext(),Xt=()=>{const t=e.useContext(Yt);if(!t)throw new Error("useUnifiedThemeContext must be used within a UnifiedThemeProvider");return t},es=({children:s})=>{const[r,a]=e.useState(null),[i,n]=e.useState(!0),[o,l]=e.useState(null),[c,d]=e.useState(new Set);e.useEffect(()=>{let e=!1;return(async()=>{try{if(n(!0),l(null),await Zt.initialize(),!e){const e=Zt.getCurrentTheme();a(e),m(e)}}catch(t){if(!e){l(t);const e=u();a(e),m(e)}}finally{e||n(!1)}})(),()=>{e=!0}},[]),e.useEffect(()=>Zt.subscribe(e=>{a(e),m(e),c.forEach(t=>{try{t(e)}catch(s){}})}),[c]);const m=e.useCallback(e=>{if(e)try{"dark"===e.mode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),Zt.applyTheme()}catch(t){}},[]),u=e.useCallback(()=>({mode:"light",palette:{name:"Default",key:"default",colors:{primary:"#3b82f6",secondary:"#a855f7",accent:"#ec4899",background:"#ffffff",surface:"#f8fafc",text:"#1f2937",textSecondary:"#6b7280"}},customColors:{},accessibility:{enforceStandards:!0,minimumContrast:4.5},createdAt:Date.now(),lastModified:Date.now()}),[]),h=e.useCallback(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?`${parseInt(t[1],16)} ${parseInt(t[2],16)} ${parseInt(t[3],16)}`:"0 0 0"},[]),g=e.useCallback(async()=>{try{l(null),await Zt.toggleMode()}catch(e){throw l(e),e}},[]),p=e.useCallback(async e=>{try{l(null),await Zt.setMode(e)}catch(t){throw l(t),t}},[]),b=e.useCallback(async e=>{try{l(null),await Zt.setColorPalette(e)}catch(t){throw l(t),t}},[]),x=e.useCallback(async(e,t)=>{try{l(null),await Zt.setCustomColor(e,t)}catch(s){throw l(s),s}},[]),y=e.useCallback(async()=>{try{l(null),await Zt.resetTheme()}catch(e){throw l(e),e}},[]),f=e.useCallback(e=>Zt.getEffectiveColor(e),[]),v=e.useCallback(async(e,t)=>{try{await x(e,t)}catch(s){}},[x]),w=e.useCallback(async()=>{try{await y()}catch(e){}},[y]),j=e.useCallback(e=>(d(t=>new Set([...t,e])),()=>{d(t=>{const s=new Set(t);return s.delete(e),s})}),[]),S=e.useCallback(()=>Zt.exportTheme(),[]),I=e.useCallback(async e=>{try{l(null);if(!(await Zt.importTheme(e)))throw new Error("Failed to import theme");return!0}catch(t){throw l(t),t}},[]),k=e.useCallback(()=>Zt.getThemeStats(),[]),N=e.useCallback(()=>Zt.getAvailablePalettes()||[],[]),C=e.useCallback(e=>Zt.validateColorAccessibility(e),[]),_={theme:r,isLoading:i,error:o,mode:r?.mode||"light",primaryColor:r?.customColors?.primary||r?.palette?.colors?.primary||"#3b82f6",secondaryColor:r?.customColors?.secondary||r?.palette?.colors?.secondary||"#a855f7",accentColor:r?.customColors?.accent||r?.palette?.colors?.accent||"#ec4899",toggleMode:g,setMode:p,setColorPalette:b,setCustomColor:x,resetTheme:y,getEffectiveColor:f,toggleTheme:g,updateColor:v,resetColors:w,subscribe:j,exportTheme:S,importTheme:I,getThemeStats:k,getAvailablePalettes:N,validateColorAccessibility:C,hexToRgb:h,currentPalette:r?.palette?.name||"Unknown",availablePalettes:N(),customColors:r?.customColors||{},accessibilityEnabled:r?.accessibility?.enforceStandards||!1,minimumContrast:r?.accessibility?.minimumContrast||4.5};return t.jsx(Yt.Provider,{value:_,children:s})},ts=()=>{try{const{unifiedColorManager:e}=require("./colorManager.js");e.getAvailablePalettes()}catch(e){}};"undefined"!=typeof window&&(window.debugThemes=ts);const ss="SET_CURRENT_PAGE",rs="SET_SELECTED_LIST",as="NAVIGATE_TO_LIST",is="NAVIGATE_TO_OVERVIEW",ns="SET_NEW_LIST_NAME",os="CLEAR_NEW_LIST_NAME",ls="SET_LOADING_STATE",cs="SET_ERROR_STATE",ds="CLEAR_ERROR_STATE",ms="OPTIMISTIC_LIST_CREATE_START",us="OPTIMISTIC_LIST_CREATE_SUCCESS",hs="OPTIMISTIC_LIST_CREATE_FAILURE",gs="OPTIMISTIC_LIST_DELETE_START",ps="OPTIMISTIC_LIST_DELETE_SUCCESS",bs="OPTIMISTIC_LIST_DELETE_FAILURE",xs="RESET_STATE",ys={currentPage:"overview",selectedList:null,newListName:"",isLoading:!1,error:null,optimisticOperations:{creatingList:null,deletingLists:[]},navigationHistory:["overview"]};function fs(e,t){switch(t.type){case ss:{const s=[...e.navigationHistory];return s[s.length-1]!==t.payload&&(s.push(t.payload),s.length>10&&s.shift()),{...e,currentPage:t.payload,navigationHistory:s,selectedList:"list"===t.payload?e.selectedList:null}}case rs:return{...e,selectedList:t.payload};case as:{const s=[...e.navigationHistory];return"list"!==s[s.length-1]&&(s.push("list"),s.length>10&&s.shift()),{...e,currentPage:"list",selectedList:t.payload,navigationHistory:s}}case is:{const t=[...e.navigationHistory];return"overview"!==t[t.length-1]&&(t.push("overview"),t.length>10&&t.shift()),{...e,currentPage:"overview",selectedList:null,navigationHistory:t}}case ns:return{...e,newListName:t.payload};case os:return{...e,newListName:""};case ls:return{...e,isLoading:t.payload};case cs:return{...e,error:t.payload,isLoading:!1};case ds:return{...e,error:null};case ms:{const s=`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return{...e,optimisticOperations:{...e.optimisticOperations,creatingList:{tempId:s,name:t.payload.name,timestamp:Date.now()}},newListName:""}}case us:return{...e,optimisticOperations:{...e.optimisticOperations,creatingList:null}};case hs:return{...e,optimisticOperations:{...e.optimisticOperations,creatingList:null},newListName:e.optimisticOperations.creatingList?.name||e.newListName,error:t.payload||"Failed to create list"};case gs:{const s=[...e.optimisticOperations.deletingLists];return s.push({listId:t.payload.listId,timestamp:Date.now()}),{...e,optimisticOperations:{...e.optimisticOperations,deletingLists:s},selectedList:e.selectedList?.id===t.payload.listId?null:e.selectedList,currentPage:"list"===e.currentPage&&e.selectedList?.id===t.payload.listId?"overview":e.currentPage}}case ps:{const s=e.optimisticOperations.deletingLists.filter(e=>e.listId!==t.payload.listId);return{...e,optimisticOperations:{...e.optimisticOperations,deletingLists:s}}}case bs:{const s=e.optimisticOperations.deletingLists.filter(e=>e.listId!==t.payload.listId);return{...e,optimisticOperations:{...e.optimisticOperations,deletingLists:s},error:t.payload.error||"Failed to delete list"}}case xs:return{...ys,navigationHistory:["overview"]};default:return e}}const vs=e=>({type:ss,payload:e}),ws=e=>({type:rs,payload:e}),js=e=>({type:as,payload:e}),Ss=()=>({type:is}),Is=e=>({type:ns,payload:e}),ks=()=>({type:os}),Ns=e=>({type:ls,payload:e}),Cs=e=>({type:cs,payload:e}),_s=()=>({type:ds}),Es=e=>({type:ms,payload:{name:e}}),Ts=()=>({type:us}),Ls=e=>({type:hs,payload:e}),Rs={getCurrentPage:e=>e.currentPage,getSelectedList:e=>e.selectedList,getNavigationHistory:e=>e.navigationHistory,canGoBack:e=>e.navigationHistory.length>1,getPreviousPage:e=>{const t=e.navigationHistory;return t.length>1?t[t.length-2]:"overview"},getNewListName:e=>e.newListName,isNewListNameValid:e=>e.newListName.trim().length>0,getIsLoading:e=>e.isLoading,getError:e=>e.error,hasError:e=>null!==e.error,getOptimisticOperations:e=>e.optimisticOperations,isCreatingList:e=>null!==e.optimisticOperations.creatingList,isDeletingList:e=>t=>t.optimisticOperations.deletingLists.some(t=>t.listId===e),getCreatingListInfo:e=>e.optimisticOperations.creatingList,getDeletingListIds:e=>e.optimisticOperations.deletingLists.map(e=>e.listId)},Ds="SET_LISTS",As="ADD_LIST",Os="UPDATE_LIST",Ms="REMOVE_LIST",Ps="SET_LISTS_LOADING",Us="SET_LISTS_ERROR",zs="CLEAR_LISTS_ERROR",qs="SET_LIST_LOADING",Bs="SET_LIST_ERROR",Fs="CLEAR_LIST_ERROR",Vs="OPTIMISTIC_ADD_LIST",$s="OPTIMISTIC_UPDATE_LIST",Hs="OPTIMISTIC_REMOVE_LIST",Ws="REVERT_OPTIMISTIC_ADD",Gs="REVERT_OPTIMISTIC_UPDATE",Js="REVERT_OPTIMISTIC_REMOVE",Qs="ADD_ITEM_TO_LIST",Ks="UPDATE_ITEM_IN_LIST",Zs="REMOVE_ITEM_FROM_LIST",Ys="TOGGLE_ITEM_IN_LIST",Xs="RESET_LISTS",er={lists:[],isLoading:!1,listsLoading:!1,error:null,listErrors:{},optimisticOperations:{adding:[],updating:[],removing:[]},stats:{total:0,owned:0,shared:0,totalItems:0,completedItems:0,lastUpdated:null}},tr=()=>`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sr=e=>{const t={total:e.length,owned:e.filter(e=>e.isCreator).length,shared:e.filter(e=>!e.isCreator).length,totalItems:0,completedItems:0,lastUpdated:Date.now()};return e.forEach(e=>{e.items&&(t.totalItems+=e.items.length,t.completedItems+=e.items.filter(e=>e.completed).length)}),t},rr=(e,t)=>e.find(e=>e.id===t),ar=(e,t,s)=>e.map(e=>e.id===t?{...e,...s,updatedAt:new Date}:e);function ir(e,t){switch(t.type){case Ds:{const s=t.payload||[];return{...e,lists:s,stats:sr(s),isLoading:!1,error:null}}case As:{const s=t.payload,r=[...e.lists,s];return{...e,lists:r,stats:sr(r)}}case Os:{const{listId:s,updates:r}=t.payload,a=ar(e.lists,s,r);return{...e,lists:a,stats:sr(a)}}case Ms:{const s=t.payload,r=e.lists.filter(e=>e.id!==s);return{...e,lists:r,stats:sr(r),listErrors:{...e.listErrors,[s]:void 0}}}case Ps:return{...e,listsLoading:t.payload};case Us:return{...e,error:t.payload,isLoading:!1,listsLoading:!1};case zs:return{...e,error:null};case qs:{const{listId:s,isLoading:r}=t.payload;return{...e,isLoading:r}}case Bs:{const{listId:s,error:r}=t.payload;return{...e,listErrors:{...e.listErrors,[s]:r}}}case Fs:{const s=t.payload;return{...e,listErrors:{...e.listErrors,[s]:void 0}}}case Vs:{const s=t.payload,r=tr(),a={...s,id:r,createdAt:new Date,updatedAt:new Date,isOptimistic:!0},i=[...e.lists,a],n=[...e.optimisticOperations.adding,{tempId:r,listData:s,timestamp:Date.now()}];return{...e,lists:i,stats:sr(i),optimisticOperations:{...e.optimisticOperations,adding:n}}}case $s:{const{listId:s,updates:r}=t.payload,a=rr(e.lists,s);if(!a)return e;const i=ar(e.lists,s,{...r,isOptimistic:!0}),n=[...e.optimisticOperations.updating,{listId:s,originalData:a,timestamp:Date.now()}];return{...e,lists:i,stats:sr(i),optimisticOperations:{...e.optimisticOperations,updating:n}}}case Hs:{const s=t.payload,r=rr(e.lists,s);if(!r)return e;const a=e.lists.filter(e=>e.id!==s),i=[...e.optimisticOperations.removing,{listId:s,originalData:r,timestamp:Date.now()}];return{...e,lists:a,stats:sr(a),optimisticOperations:{...e.optimisticOperations,removing:i}}}case Ws:{const s=t.payload,r=e.lists.filter(e=>e.id!==s),a=e.optimisticOperations.adding.filter(e=>e.tempId!==s);return{...e,lists:r,stats:sr(r),optimisticOperations:{...e.optimisticOperations,adding:a}}}case Gs:{const s=t.payload,r=e.optimisticOperations.updating.find(e=>e.listId===s);if(!r)return e;const a=e.lists.map(e=>e.id===s?r.originalData:e),i=e.optimisticOperations.updating.filter(e=>e.listId!==s);return{...e,lists:a,stats:sr(a),optimisticOperations:{...e.optimisticOperations,updating:i}}}case Js:{const s=t.payload,r=e.optimisticOperations.removing.find(e=>e.listId===s);if(!r)return e;const a=[...e.lists,r.originalData],i=e.optimisticOperations.removing.filter(e=>e.listId!==s);return{...e,lists:a,stats:sr(a),optimisticOperations:{...e.optimisticOperations,removing:i}}}case Qs:{const{listId:s,item:r}=t.payload,a=e.lists.map(e=>{if(e.id===s){const t={id:r.id||tr(),text:r.text,completed:r.completed||!1,createdAt:new Date,...r};return{...e,items:[...e.items||[],t],updatedAt:new Date}}return e});return{...e,lists:a,stats:sr(a)}}case Ks:{const{listId:s,itemId:r,updates:a}=t.payload,i=e.lists.map(e=>{if(e.id===s){const t=(e.items||[]).map(e=>e.id===r?{...e,...a,updatedAt:new Date}:e);return{...e,items:t,updatedAt:new Date}}return e});return{...e,lists:i,stats:sr(i)}}case Zs:{const{listId:s,itemId:r}=t.payload,a=e.lists.map(e=>{if(e.id===s){const t=(e.items||[]).filter(e=>e.id!==r);return{...e,items:t,updatedAt:new Date}}return e});return{...e,lists:a,stats:sr(a)}}case Ys:{const{listId:s,itemId:r}=t.payload,a=e.lists.map(e=>{if(e.id===s){const t=(e.items||[]).map(e=>e.id===r?{...e,completed:!e.completed,updatedAt:new Date}:e);return{...e,items:t,updatedAt:new Date}}return e});return{...e,lists:a,stats:sr(a)}}case Xs:return er;default:return e}}const nr=e=>({type:Ds,payload:e}),or=e=>({type:As,payload:e}),lr=(e,t)=>({type:Os,payload:{listId:e,updates:t}}),cr=e=>({type:Ms,payload:e}),dr=e=>({type:Ps,payload:e}),mr=e=>({type:Us,payload:e}),ur=()=>({type:zs}),hr=e=>({type:Vs,payload:e}),gr=(e,t)=>({type:$s,payload:{listId:e,updates:t}}),pr=e=>({type:Hs,payload:e}),br=e=>({type:Ws,payload:e}),xr=e=>({type:Gs,payload:e}),yr=e=>({type:Js,payload:e}),fr=(e,t)=>({type:Qs,payload:{listId:e,item:t}}),vr=(e,t,s)=>({type:Ks,payload:{listId:e,itemId:t,updates:s}}),wr=(e,t)=>({type:Zs,payload:{listId:e,itemId:t}}),jr=(e,t)=>({type:Ys,payload:{listId:e,itemId:t}}),Sr={getLists:e=>e.lists,getListById:e=>t=>rr(t.lists,e),getListsLoading:e=>e.listsLoading,getListsError:e=>e.error,getListError:e=>t=>t.listErrors[e],getOwnedLists:e=>e.lists.filter(e=>e.isCreator),getSharedLists:e=>e.lists.filter(e=>!e.isCreator),getVisibleLists:e=>e.lists.filter(e=>!e.isOptimistic||e.isOptimistic),getStats:e=>e.stats,getTotalLists:e=>e.stats.total,getOwnedListsCount:e=>e.stats.owned,getSharedListsCount:e=>e.stats.shared,getTotalItems:e=>e.stats.totalItems,getCompletedItems:e=>e.stats.completedItems,getOptimisticOperations:e=>e.optimisticOperations,isListOptimistic:e=>t=>{const s=rr(t.lists,e);return s?.isOptimistic||!1},getListItems:e=>t=>{const s=rr(t.lists,e);return s?.items||[]},getCompletedItemsInList:e=>t=>{const s=rr(t.lists,e);return(s?.items||[]).filter(e=>e.completed)},getPendingItemsInList:e=>t=>{const s=rr(t.lists,e);return(s?.items||[]).filter(e=>!e.completed)}},Ir="boodschappenlijst_app_state",kr="boodschappenlijst_list_state",Nr="boodschappenlijst_state_version",Cr="1.0.0",_r={persist:["currentPage","newListName","navigationHistory"],exclude:["isLoading","error","optimisticOperations"]},Er={persist:["lists","stats"],exclude:["isLoading","listsLoading","error","listErrors","optimisticOperations"]},Tr=500,Lr=10;class Rr{constructor(e){this.delay=e,this.timeouts=new Map}debounce(e,t){this.timeouts.has(e)&&clearTimeout(this.timeouts.get(e));const s=setTimeout(()=>{t(),this.timeouts.delete(e)},this.delay);this.timeouts.set(e,s)}clear(){this.timeouts.forEach(e=>clearTimeout(e)),this.timeouts.clear()}}const Dr=new class{constructor(){this.debouncer=new Rr(Tr),this.isInitialized=!1,this.migrationHandlers=new Map,this.setupMigrationHandlers()}initialize(){if(!this.isInitialized)try{this.handleStateMigration(),this.isInitialized=!0}catch(e){_t.logError(e,"state_persistence_init")}}setupMigrationHandlers(){this.migrationHandlers.set("0.9.0",e=>({...e}))}handleStateMigration(){try{const e=localStorage.getItem(Nr);e&&e===Cr||(this.clearPersistedState(),localStorage.setItem(Nr,Cr))}catch(e){_t.logError(e,"state_migration"),this.clearPersistedState()}}filterStateForPersistence(e,t){const s={};return t.persist?t.persist.forEach(t=>{e.hasOwnProperty(t)&&(s[t]=e[t])}):Object.assign(s,e),t.exclude&&t.exclude.forEach(e=>{delete s[e]}),s}persistAppState(e){this.isInitialized||this.initialize(),this.debouncer.debounce("appState",()=>{try{const t=this.filterStateForPersistence(e,_r);t.navigationHistory&&t.navigationHistory.length>Lr&&(t.navigationHistory=t.navigationHistory.slice(-Lr));const s=JSON.stringify(t);localStorage.setItem(Ir,s)}catch(t){_t.logError(t,"persist_app_state",{stateKeys:Object.keys(e)})}})}persistListState(e){this.isInitialized||this.initialize(),this.debouncer.debounce("listState",()=>{try{const t=this.filterStateForPersistence(e,Er);t.lists&&(t.lists=t.lists.filter(e=>!e.isOptimistic));const s=JSON.stringify(t);localStorage.setItem(kr,s)}catch(t){_t.logError(t,"persist_list_state",{listCount:e.lists?.length||0})}})}restoreAppState(e){this.isInitialized||this.initialize();try{const t=localStorage.getItem(Ir);if(!t)return e;const s=JSON.parse(t);return{...e,...s,isLoading:!1,error:null,optimisticOperations:e.optimisticOperations}}catch(t){return _t.logError(t,"restore_app_state"),e}}restoreListState(e){this.isInitialized||this.initialize();try{const t=localStorage.getItem(kr);if(!t)return e;const s=JSON.parse(t),r={...e,...s,isLoading:!1,listsLoading:!1,error:null,listErrors:{},optimisticOperations:e.optimisticOperations};return r.lists&&Array.isArray(r.lists)&&(r.lists=r.lists.filter(e=>e&&"object"==typeof e&&e.id&&e.name)),r}catch(t){return _t.logError(t,"restore_list_state"),e}}clearPersistedState(){try{localStorage.removeItem(Ir),localStorage.removeItem(kr),localStorage.removeItem(Nr)}catch(e){_t.logError(e,"clear_persisted_state")}}getStorageInfo(){try{const e=localStorage.getItem(Ir)?.length||0,t=localStorage.getItem(kr)?.length||0,s=e+t;return{appStateSize:e,listStateSize:t,totalSize:s,totalSizeKB:Math.round(s/1024*100)/100}}catch(e){return{appStateSize:0,listStateSize:0,totalSize:0,totalSizeKB:0}}}exportState(){try{const e=localStorage.getItem(Ir),t=localStorage.getItem(kr);return{version:localStorage.getItem(Nr)||Cr,appState:e?JSON.parse(e):null,listState:t?JSON.parse(t):null,exportedAt:(new Date).toISOString()}}catch(e){return _t.logError(e,"export_state"),null}}importState(e){try{if(!e||"object"!=typeof e)throw new Error("Invalid export data");return this.clearPersistedState(),e.appState&&localStorage.setItem(Ir,JSON.stringify(e.appState)),e.listState&&localStorage.setItem(kr,JSON.stringify(e.listState)),localStorage.setItem(Nr,e.version||Cr),!0}catch(t){return _t.logError(t,"import_state"),!1}}cleanup(){this.debouncer.clear(),this.isInitialized=!1}};function Ar(e,t){return(s,r)=>{const a=e(s,r);return"app"===t?Dr.persistAppState(a):"list"===t&&Dr.persistListState(a),a}}"undefined"!=typeof window&&(window.statePersistence=Dr);const Or=s.memo(({list:s,onOpenList:r,onShare:a,onUserManagement:n,onDelete:o})=>{const{measureRender:l}=ct("ListCard"),c=e.useCallback(()=>{r(s)},[r,s]),m=e.useCallback(e=>{e.stopPropagation(),a(s.id)},[a,s.id]),u=e.useCallback(e=>{e.stopPropagation(),n(s.id)},[n,s.id]),h=e.useCallback(e=>{e.stopPropagation(),o(s.id)},[o,s.id]),g=e.useCallback(e=>{e.stopPropagation(),r(s)},[r,s]),{completedItems:p,totalItems:b,progressPercentage:x}=e.useMemo(()=>{const e=s.items?.filter(e=>e.completed).length||0,t=s.items?.length||0;return{completedItems:e,totalItems:t,progressPercentage:t>0?Math.round(e/t*100):0}},[s.items]),y=e.useMemo(()=>{if(!s.updatedAt)return"";const e=s.updatedAt.toDate?s.updatedAt.toDate():new Date(s.updatedAt),t=new Date-e,r=Math.floor(t/36e5),a=Math.floor(t/864e5);return r<1?"Zojuist":r<24&&0===a?`${r}u geleden`:1===a?"Gisteren":a<7?`${a} dagen geleden`:e.toLocaleDateString("nl-NL",{day:"numeric",month:"short"})},[s.updatedAt]),w=e.useMemo(()=>"px-3 py-1.5 text-xs font-semibold rounded-full inline-block "+(s.isCreator?"bg-[rgb(var(--primary-color))]/20 text-[rgb(var(--primary-color))] border border-[rgb(var(--primary-color))]/20":"bg-[rgb(var(--secondary-color))]/20 text-[rgb(var(--secondary-color))] border border-[rgb(var(--secondary-color))]/20"),[s.isCreator]),j=e.useMemo(()=>he(s),[s]);return l(()=>t.jsxs(H.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"group bg-[rgb(var(--card-bg))] rounded-xl md:rounded-2xl shadow-lg border border-[rgb(var(--border-color))]/20 p-4 md:p-6 lg:p-6 xl:p-8 hover:shadow-2xl hover:border-[rgb(var(--border-color))]/40 transition-all duration-300 cursor-pointer relative overflow-visible",onClick:c,children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-secondary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"mb-4 lg:mb-6",children:[t.jsx("h3",{className:"text-base md:text-lg lg:text-xl xl:text-2xl font-bold text-[rgb(var(--card-text))] mb-2 md:mb-3 group-hover:text-primary transition-colors duration-200 break-words leading-tight ipad-simple-fix",children:s.name}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 text-xs md:text-sm text-[rgb(var(--text-color))]/60 mb-2 md:mb-3",children:[t.jsxs("span",{className:"whitespace-nowrap",children:[b," item",1!==b?"s":""]}),s.sharedWith&&s.sharedWith.length>0&&t.jsxs("span",{className:"flex items-center whitespace-nowrap",children:[t.jsx(f,{className:"w-3 h-3 mr-1"}),s.sharedWith.length," gedeeld"]})]}),s.creatorName&&t.jsxs("div",{className:"text-xs text-[rgb(var(--text-color))]/50 mb-2 md:mb-3 break-words ipad-simple-fix",children:["Gemaakt door ",s.creatorName]}),t.jsxs("div",{className:"flex items-center justify-between gap-2 md:gap-3 mb-2",children:[t.jsx("span",{className:w,children:s.isCreator?"Eigenaar":"Gedeeld"}),s.updatedAt&&t.jsx("span",{className:"text-xs text-[rgb(var(--text-color))]/40 whitespace-nowrap",children:y})]})]}),b>0&&t.jsxs("div",{className:"mb-4 md:mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-xs text-[rgb(var(--text-color))]/60",children:"Voortgang"}),t.jsxs("span",{className:"text-xs font-medium text-[rgb(var(--card-text))]",children:[x,"%"]})]}),t.jsx("div",{className:"progress-bar-container h-2",children:t.jsx("div",{className:"progress-bar-fill",style:{width:`${Math.max(0,Math.min(100,x))}%`}})})]}),t.jsxs("div",{className:"space-y-2 md:space-y-3",children:[t.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center px-3 md:px-4 py-2 md:py-2.5 lg:py-3 xl:py-4 bg-[rgb(var(--color-primary-button))] hover:opacity-90 text-white rounded-lg md:rounded-xl lg:rounded-2xl shadow-lg hover:shadow-xl transform active:scale-95 sm:hover:scale-105 transition-all duration-200 font-semibold text-xs md:text-sm lg:text-base xl:text-lg touch-manipulation",children:[t.jsx(i,{className:"w-3 h-3 md:w-4 md:h-4 lg:w-5 lg:h-5 xl:w-6 xl:h-6 mr-2 md:mr-3"}),t.jsx("span",{children:"Lijst Openen"})]}),t.jsxs("button",{onClick:m,className:"w-full flex items-center justify-center px-3 md:px-4 py-2 md:py-2.5 lg:py-3 xl:py-4 bg-[rgb(var(--color-secondary-button))] hover:opacity-90 text-white rounded-lg md:rounded-xl lg:rounded-2xl shadow-lg hover:shadow-xl transform active:scale-95 sm:hover:scale-105 transition-all duration-200 font-semibold text-xs md:text-sm lg:text-base xl:text-lg touch-manipulation",title:"Delen",children:[t.jsx(v,{className:"w-3 h-3 md:w-4 md:h-4 lg:w-5 lg:h-5 xl:w-6 xl:h-6 mr-2 md:mr-3"}),t.jsx("span",{children:"Delen"})]}),(s.isCreator||j)&&t.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:gap-3",children:[s.isCreator&&t.jsxs("button",{onClick:u,className:"flex-1 flex items-center justify-center px-3 md:px-4 py-2 md:py-2.5 lg:py-3 bg-[rgb(var(--color-info-button))] hover:opacity-90 text-white rounded-lg lg:rounded-xl shadow-md hover:shadow-lg transform active:scale-95 sm:hover:scale-105 transition-all duration-200 font-medium text-xs md:text-sm lg:text-base touch-manipulation",title:"Gebruikers beheren",children:[t.jsx(f,{className:"w-3 h-3 md:w-4 md:h-4 lg:w-5 lg:h-5 mr-1 md:mr-2"}),t.jsx("span",{children:"Gebruikers"})]}),j&&t.jsxs("button",{onClick:h,className:"flex-1 flex items-center justify-center px-3 md:px-4 py-2 md:py-2.5 lg:py-3 bg-[rgb(var(--color-error-button))] hover:opacity-90 text-white rounded-lg lg:rounded-xl shadow-md hover:shadow-lg transform active:scale-95 sm:hover:scale-105 transition-all duration-200 font-medium text-xs md:text-sm lg:text-base touch-manipulation",title:"Verwijderen",children:[t.jsx(d,{className:"w-3 h-3 md:w-4 md:h-4 lg:w-5 lg:h-5 mr-1 md:mr-2"}),t.jsx("span",{children:"Verwijderen"})]})]})]})]})]}))});Or.displayName="ListCard",Or.propTypes={list:Ze.isRequired,onOpenList:et.isRequired,onShare:et.isRequired,onUserManagement:et.isRequired,onDelete:et.isRequired};const Mr=({currentPage:e,onNavigate:s,onToggleTheme:r,onOpenScanner:a,onOpenPerformanceDashboard:i,theme:n,listsCount:o})=>{const l="undefined"!=typeof window&&"true"===new URLSearchParams(window.location.search).get("dev"),c=[{id:"overview",label:"Overzicht",icon:w,onClick:()=>s("overview")},{id:"settings",label:"Instellingen",icon:j,onClick:()=>s("settings")},{id:"analytics",label:"Analytics",icon:S,onClick:()=>s("analytics")},{id:"theme",label:"Thema",icon:I,onClick:()=>s("theme")},{id:"persistence",label:"Persistentie",icon:k,onClick:()=>s("persistence")}];return t.jsxs(t.Fragment,{children:[t.jsxs("nav",{className:"hidden lg:flex items-center space-x-2 xl:space-x-4",children:[c.map(({id:s,label:r,icon:a,onClick:i})=>{return t.jsxs("button",{onClick:i,className:(n=s,"px-4 xl:px-6 py-2.5 rounded-xl font-medium transition-all duration-200 "+(e===n||!e&&"overview"===n?"bg-[rgb(var(--primary-color))] text-white shadow-lg":"text-[rgb(var(--text-color))]/80 hover:bg-[rgb(var(--border-color))]/20 hover:text-[rgb(var(--card-text))]")),children:[t.jsx(a,{className:"w-4 h-4 inline mr-2"}),r]},s);var n}),t.jsxs("button",{onClick:a,className:"px-4 xl:px-6 py-2.5 rounded-xl font-medium text-[rgb(var(--text-color))]/80 hover:bg-[rgb(var(--border-color))]/20 hover:text-[rgb(var(--card-text))] transition-all duration-200",children:[t.jsx(N,{className:"w-4 h-4 inline mr-2"}),"QR Scanner"]}),l&&i&&t.jsxs("button",{onClick:i,className:"px-4 xl:px-6 py-2.5 rounded-xl font-medium text-blue-400 hover:bg-blue-500/20 hover:text-blue-300 transition-all duration-200 border border-blue-500/30",title:"Open Performance Dashboard (Dev Mode)",children:[t.jsx(p,{className:"w-4 h-4 inline mr-2"}),"Performance"]}),t.jsx("div",{className:"w-px h-8 bg-[rgb(var(--border-color))]/30"}),t.jsxs("div",{className:"flex items-center space-x-1 xl:space-x-2",children:[t.jsxs("span",{className:"text-sm text-[rgb(var(--text-color))]/60 font-medium",children:[o," lijst",1!==o?"en":""]}),t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"})]})]}),t.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-2 lg:space-x-3 flex-shrink-0 pr-2 sm:pr-0 lg:hidden",children:[l&&i&&t.jsx("button",{onClick:i,className:"flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-blue-600 hover:bg-blue-700 text-white shadow-md hover:shadow-lg transform active:scale-95 transition-all duration-200","aria-label":"Performance Dashboard",title:"Performance Dashboard (Dev Mode)",children:t.jsx(p,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),t.jsx("button",{onClick:a,className:"flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-[rgb(var(--color-secondary-button))] hover:opacity-90 text-white shadow-md hover:shadow-lg transform active:scale-95 transition-all duration-200","aria-label":"QR-code scannen",children:t.jsx(N,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),t.jsx("button",{onClick:r,className:"flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-[rgb(var(--color-primary-button))] hover:opacity-90 text-white shadow-md hover:shadow-lg transform active:scale-95 sm:hover:scale-105 transition-all duration-200 group","aria-label":"Thema wisselen",children:t.jsx("span",{className:"text-sm sm:text-base group-hover:scale-110 transition-transform duration-200",children:"light"===n?"🌙":"☀️"})}),t.jsx("button",{onClick:()=>s("settings"),className:"flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-[rgb(var(--border-color))]/60 hover:bg-[rgb(var(--border-color))]/80 text-[rgb(var(--card-text))] shadow-md hover:shadow-lg transform active:scale-95 sm:hover:scale-105 transition-all duration-200 group","aria-label":"Instellingen",children:t.jsx(j,{className:"w-4 h-4 sm:w-5 sm:h-5 group-hover:rotate-90 transition-transform duration-300"})})]}),t.jsxs("div",{className:"hidden lg:flex items-center space-x-3 flex-shrink-0",children:[l&&i&&t.jsx("button",{onClick:i,className:"flex items-center justify-center w-12 h-12 rounded-lg bg-blue-600 hover:bg-blue-700 text-white shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 group","aria-label":"Performance Dashboard",title:"Performance Dashboard (Dev Mode)",children:t.jsx(p,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"})}),t.jsx("button",{onClick:r,className:"flex items-center justify-center w-12 h-12 rounded-lg bg-[rgb(var(--color-primary-button))] hover:opacity-90 text-white shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 group","aria-label":"Thema wisselen",children:t.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform duration-200",children:"light"===n?"🌙":"☀️"})}),t.jsx("button",{onClick:()=>s("settings"),className:"flex items-center justify-center w-12 h-12 rounded-lg bg-[rgb(var(--border-color))]/60 hover:bg-[rgb(var(--border-color))]/80 text-[rgb(var(--card-text))] shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 group","aria-label":"Instellingen",children:t.jsx(j,{className:"w-6 h-6 group-hover:rotate-90 transition-transform duration-300"})})]})]})};function Pr(){const{userInfo:r,setUserName:a,isLoading:i}=function(){const[t,s]=e.useState(null),[r,a]=e.useState(!0),[i,n]=e.useState(null);return e.useEffect(()=>{let e=!1;return(async()=>{try{a(!0),n(null);const t=await zt.getUserInfo();e||s(t)}catch(t){e||n(t)}finally{e||a(!1)}})(),()=>{e=!0}},[]),e.useEffect(()=>$t.subscribe("user",async()=>{try{const e=await zt.getUserInfo();s(e)}catch(e){n(e)}}),[]),{userInfo:t,setUserName:e.useCallback(async e=>{try{n(null),await zt.setUserName(e);const t=await zt.getUserInfo();return s(t),!0}catch(t){throw n(t),t}},[]),clearUserName:e.useCallback(async()=>{try{n(null),await zt.clearUserName();const e=await zt.getUserInfo();return s(e),!0}catch(e){throw n(e),e}},[]),isLoading:r,error:i}}(),{getCurrentPage:n,getSelectedList:o,getNewListName:l,isNewListNameValid:c,isCreatingList:d,setCurrentPage:m,setSelectedList:u,navigateToList:h,setNewListName:g,optimisticListCreateStart:p,optimisticListCreateSuccess:b,optimisticListCreateFailure:x,optimisticRemoveList:y,revertOptimisticRemove:f}=function(){const t=e.useMemo(()=>Ar(fs,"app"),[]),s=e.useMemo(()=>Ar(ir,"list"),[]),[r,a]=e.useReducer(t,ys,e=>Dr.restoreAppState(e)),[i,n]=e.useReducer(s,er,e=>Dr.restoreListState(e));e.useEffect(()=>(Dr.initialize(),()=>{Dr.cleanup()}),[]);const o=e.useCallback(e=>{try{a(vs(e))}catch(A){_t.logError(A,"app_state_navigation",{page:e})}},[]),l=e.useCallback(e=>{try{a(ws(e))}catch(A){_t.logError(A,"app_state_selection",{listId:e?.id})}},[]),c=e.useCallback(e=>{try{a(js(e))}catch(A){_t.logError(A,"app_state_navigate_list",{listId:e?.id})}},[]),d=e.useCallback(()=>{try{a(Ss())}catch(A){_t.logError(A,"app_state_navigate_overview")}},[]),m=e.useCallback(e=>{try{a(Is(e))}catch(A){_t.logError(A,"app_state_form",{nameLength:e?.length})}},[]),u=e.useCallback(()=>{try{a(ks())}catch(A){_t.logError(A,"app_state_clear_form")}},[]),h=e.useCallback(e=>{try{a(Ns(e))}catch(A){_t.logError(A,"app_state_loading",{isLoading:e})}},[]),g=e.useCallback(e=>{try{a(Cs(e))}catch(t){_t.logError(t,"app_state_error",{originalError:e})}},[]),p=e.useCallback(()=>{try{a(_s())}catch(A){_t.logError(A,"app_state_clear_error")}},[]),b=e.useCallback(e=>{try{a(Es(e))}catch(A){_t.logError(A,"app_state_optimistic_create",{name:e})}},[]),x=e.useCallback(()=>{try{a(Ts())}catch(A){_t.logError(A,"app_state_optimistic_create_success")}},[]),y=e.useCallback(e=>{try{a(Ls(e))}catch(t){_t.logError(t,"app_state_optimistic_create_failure",{originalError:e})}},[]),f=e.useCallback(e=>{try{n(nr(e))}catch(A){_t.logError(A,"list_state_set_lists",{listCount:e?.length})}},[]),v=e.useCallback(e=>{try{n(or(e))}catch(A){_t.logError(A,"list_state_add_list",{listId:e?.id})}},[]),w=e.useCallback((e,t)=>{try{n(lr(e,t))}catch(A){_t.logError(A,"list_state_update_list",{listId:e,updateKeys:Object.keys(t||{})})}},[]),j=e.useCallback(e=>{try{n(cr(e))}catch(A){_t.logError(A,"list_state_remove_list",{listId:e})}},[]),S=e.useCallback(e=>{try{n(dr(e))}catch(A){_t.logError(A,"list_state_loading",{isLoading:e})}},[]),I=e.useCallback(e=>{try{n(mr(e))}catch(t){_t.logError(t,"list_state_error",{originalError:e})}},[]),k=e.useCallback(()=>{try{n(ur())}catch(A){_t.logError(A,"list_state_clear_error")}},[]),N=e.useCallback(e=>{try{n(hr(e))}catch(A){_t.logError(A,"list_state_optimistic_add",{listName:e?.name})}},[]),C=e.useCallback((e,t)=>{try{n(gr(e,t))}catch(A){_t.logError(A,"list_state_optimistic_update",{listId:e,updateKeys:Object.keys(t||{})})}},[]),_=e.useCallback(e=>{try{n(pr(e))}catch(A){_t.logError(A,"list_state_optimistic_remove",{listId:e})}},[]),E=e.useCallback(e=>{try{n(br(e))}catch(A){_t.logError(A,"list_state_revert_add",{tempId:e})}},[]),T=e.useCallback(e=>{try{n(xr(e))}catch(A){_t.logError(A,"list_state_revert_update",{listId:e})}},[]),L=e.useCallback(e=>{try{n(yr(e))}catch(A){_t.logError(A,"list_state_revert_remove",{listId:e})}},[]),R=e.useCallback((e,t)=>{try{n(fr(e,t))}catch(A){_t.logError(A,"list_state_add_item",{listId:e,itemText:t?.text})}},[]),D=e.useCallback((e,t,s)=>{try{n(vr(e,t,s))}catch(A){_t.logError(A,"list_state_update_item",{listId:e,itemId:t,updateKeys:Object.keys(s||{})})}},[]),O=e.useCallback((e,t)=>{try{n(wr(e,t))}catch(A){_t.logError(A,"list_state_remove_item",{listId:e,itemId:t})}},[]),M=e.useCallback((e,t)=>{try{n(jr(e,t))}catch(A){_t.logError(A,"list_state_toggle_item",{listId:e,itemId:t})}},[]),P=e.useMemo(()=>{const e=Rs.getSelectedList(r);return e?Sr.getListById(e.id)(i):null},[r.selectedList,i.lists]),U=e.useMemo(()=>({currentPage:Rs.getCurrentPage(r),selectedList:Rs.getSelectedList(r),canGoBack:Rs.canGoBack(r),previousPage:Rs.getPreviousPage(r)}),[r.currentPage,r.selectedList,r.navigationHistory]),z=e.useMemo(()=>({...Object.keys(Rs).reduce((e,t)=>(e[t]=Rs[t](r),e),{}),...Object.keys(Sr).reduce((e,t)=>{const s=Sr[t];return e[t]="function"==typeof s?(...e)=>s(...e)(i):s(i),e},{}),getSelectedListData:P,getNavigationContext:U}),[r,i,P,U]),q=e.useCallback(()=>Dr.exportState(),[]),B=e.useCallback(e=>Dr.importState(e),[]),F=e.useCallback(()=>{Dr.clearPersistedState()},[]),V=e.useCallback(()=>Dr.getStorageInfo(),[]),$=e.useCallback(()=>({appState:r,listState:i,storageInfo:Dr.getStorageInfo(),timestamp:(new Date).toISOString()}),[r,i]),H=e.useMemo(()=>({exportState:q,importState:B,clearPersistedState:F,getStorageInfo:V,getDebugInfo:$}),[q,B,F,V,$]);return{appState:r,listState:i,setCurrentPage:o,setSelectedList:l,navigateToList:c,navigateToOverview:d,setNewListName:m,clearNewListName:u,setLoadingState:h,setErrorState:g,clearErrorState:p,optimisticListCreateStart:b,optimisticListCreateSuccess:x,optimisticListCreateFailure:y,setLists:f,addList:v,updateList:w,removeList:j,setListsLoading:S,setListsError:I,clearListsError:k,optimisticAddList:N,optimisticUpdateList:C,optimisticRemoveList:_,revertOptimisticAdd:E,revertOptimisticUpdate:T,revertOptimisticRemove:L,addItemToList:R,updateItemInList:D,removeItemFromList:O,toggleItemInList:M,...z,...H}}(),{mode:v,toggleMode:S,isLoading:I}=Xt(),{theme:k,toggleTheme:E}=(()=>{const t=e.useContext(G);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t})(),{toasts:T,removeToast:L,removeToastByMessage:R,success:D,error:A,info:O,deleteToast:M}=K(),{lists:P,isLoading:U,firebaseError:z,initializeLists:q,retryConnection:B,handleSharedListFromURL:F}=(()=>{const[t,s]=e.useState([]),[r,a]=e.useState(!1),[i,n]=e.useState(!0),[o,l]=e.useState(null),{error:c}=K(),d=e.useCallback(async()=>{try{n(!0),l(null);const{error:e}=await _t.withRetry(()=>ae(),{operation:"firebase_init",context:{},maxRetries:3});if(e)return l(e),n(!1),_t.logError(e,"firebase_init"),{error:e};setTimeout(async()=>{try{const e=ie();if(e){const t=await _t.withRetry(()=>oe(),{operation:"load_lists",context:{userID:e}});s(t);const r=pe(e=>{s(e)});return n(!1),{unsubscribe:r}}}catch(e){return l(e),n(!1),_t.logError(e,"load_lists",{userID:ie()}),{error:e}}},1e3)}catch(A){return l(A),n(!1),_t.logError(A,"firebase_init"),{error:A}}},[]),m=e.useCallback(()=>{n(!0),l(null),d()},[d]),u=e.useCallback(async(e=t)=>{const s=window.location.hash.match(/^#\/shared\/(.+)$/);if(s){const t=s[1];try{const{getListById:s,shareListWithUser:r}=await ye(async()=>{const{getListById:e,shareListWithUser:t}=await Promise.resolve().then(()=>be);return{getListById:e,shareListWithUser:t}},void 0);if(!(await _t.withRetry(()=>s(t),{operation:"url_get_shared_list",context:{listId:t},maxRetries:2})))return c("Gedeelde lijst niet gevonden of niet toegankelijk"),void(window.location.hash="");const a=ie();if(e.some(e=>e.id===t))return void(window.location.hash="");await _t.withRetry(()=>r(t,a),{operation:"url_share_list",context:{listId:t,currentUserId:a},maxRetries:2}),window.location.hash=""}catch(r){const e=_t.getUserMessage(r,"url_share_list");c(e),_t.logError(r,"url_share_list",{listId:t}),window.location.hash=""}}},[t,c]),h=e.useCallback(()=>t.filter(e=>e.isCreator),[t]),g=e.useCallback(()=>t.filter(e=>!e.isCreator),[t]),p=e.useCallback(()=>t.reduce((e,t)=>e+(t.items||[]).length,0),[t]),b=e.useCallback(()=>({total:t.length,owned:h().length,shared:g().length,totalItems:p()}),[t,h,g,p]);return{lists:t,listsLoading:r,isLoading:i,firebaseError:o,initializeLists:d,retryConnection:m,handleSharedListFromURL:u,getOwnedLists:h,getSharedLists:g,getTotalItemCount:p,getListStats:b,setLists:s,setListsLoading:a}})(),{isProcessingQRScan:V,createList:$,deleteList:W,handleQRScan:J}=((t,s)=>{const[r,a]=e.useState(!1),[i,n]=e.useState(!1),{success:o,error:l,info:c}=K();return{isCreatingList:r,isProcessingQRScan:i,createList:e.useCallback(async e=>{const r=(e=>{if(!e||"string"!=typeof e)return{valid:!1,error:"Lijstnaam is verplicht"};const t=e.trim();return 0===t.length?{valid:!1,error:"Lijstnaam mag niet leeg zijn"}:t.length>100?{valid:!1,error:"Lijstnaam mag maximaal 100 tekens zijn"}:/[<>"'&]/.test(t)?{valid:!1,error:"Lijstnaam bevat ongeldige tekens"}:{valid:!0,value:t}})(e);if(!r.valid)return l(r.error),{success:!1,error:r.error};try{const e=ie();if(!e){const e="Gebruiker niet ingelogd. Probeer de pagina te vernieuwen.";return l(e),{success:!1,error:e}}if(!s?.name){const e="Je naam is niet ingesteld. Vernieuw de pagina om je naam in te stellen.";return l(e),{success:!1,error:e}}a(!0);const i=r.value.toLowerCase().trim();if(t.some(t=>t.name.toLowerCase().trim()===i&&t.creatorId===e)){const e=`⚠️ Lijst "${r.value}" bestaat al! Kies een andere naam.`;return l(e,2e3),{success:!1,error:e}}try{const{getShoppingLists:t}=await ye(async()=>{const{getShoppingLists:e}=await Promise.resolve().then(()=>be);return{getShoppingLists:e}},void 0);if((await _t.withRetry(()=>t(),{operation:"duplicate_check",context:{listName:r.value}})).some(t=>t.name.toLowerCase().trim()===i&&t.creatorId===e)){const e=`⚠️ Lijst "${r.value}" bestaat al! Kies een andere naam.`;return l(e,2e3),{success:!1,error:e}}}catch(z){_t.logError(z,"duplicate_check",{listName:r.value})}const n={name:r.value,items:[],creatorName:s.name,deviceUID:e,creatorId:e},c=await _t.withRetry(()=>ne(n),{operation:"create_list",context:{listName:r.value}});return o(`Lijst "${r.value}" is aangemaakt! 🎉`),{success:!0,listId:c,listData:n}}catch(i){const e=_t.getUserMessage(i,"create_list");return l(e),_t.logError(i,"create_list",{listName:r.value}),{success:!1,error:e}}finally{a(!1)}},[t,s,l,o]),deleteList:e.useCallback(async e=>{const s=t.find(t=>t.id===e);if(!s){const e="Lijst niet gevonden";return l(e),{success:!1,error:e}}if(!he(s)){const e="Alleen de maker van de lijst kan deze verwijderen";return l(e),{success:!1,error:e}}try{const t=s.name;return await _t.withRetry(()=>ce(e),{operation:"delete_list",context:{listId:e,listName:t}}),o(`Lijst "${t}" is verwijderd.`,3e3),{success:!0,listName:t}}catch(r){const t=_t.getUserMessage(r,"delete_list");return l(t,3e3),_t.logError(r,"delete_list",{listId:e,listName:s.name}),{success:!1,error:t}}},[t,l,o]),shareList:e.useCallback(async(e,t)=>{try{return await _t.withRetry(()=>de(e,t),{operation:"share_list",context:{listId:e,userIdToShareWith:t}}),o("Lijst succesvol gedeeld! 🎉"),{success:!0}}catch(s){const r=_t.getUserMessage(s,"share_list");return l(r),_t.logError(s,"share_list",{listId:e,userIdToShareWith:t}),{success:!1,error:r}}},[o,l]),removeUserFromSharedList:e.useCallback(async(e,t)=>{try{return await _t.withRetry(()=>me(e,t),{operation:"remove_user_access",context:{listId:e,userIdToRemove:t}}),o("Gebruiker toegang ingetrokken"),{success:!0}}catch(s){const r=_t.getUserMessage(s,"remove_user_access");return l(r),_t.logError(s,"remove_user_access",{listId:e,userIdToRemove:t}),{success:!1,error:r}}},[o,l]),handleQRScan:e.useCallback(async e=>{n(!0);try{const r=(e=>{if(!e||"string"!=typeof e)return{valid:!1,error:"Ongeldige QR-code: geen geldige tekst"};if(e.length>500)return{valid:!1,error:"QR-code te lang"};try{let t=null;const s=e.trim().replace(/[\u003c\u003e"'\u0026]/g,"");if(s.includes("#/shared/")){const e=s.split("#/shared/");if(2===e.length){const s=e[1].split(/[?#]/)[0];/^[a-zA-Z0-9_-]+$/.test(s)&&s.length>=10&&s.length<=30&&(t=s)}}else if(s.includes("/shared/")){const e=s.split("/shared/");if(2===e.length){const s=e[1].split(/[?#]/)[0];/^[a-zA-Z0-9_-]+$/.test(s)&&s.length>=10&&s.length<=30&&(t=s)}}else if(s.includes("#")){const e=s.split("#");if(2===e.length){const s=e[1];/^[a-zA-Z0-9_-]+$/.test(s)&&s.length>=10&&s.length<=30&&(t=s)}}else/^[a-zA-Z0-9_-]+$/.test(s)&&s.length>=10&&s.length<=30&&(t=s);if(!t)return{valid:!1,error:"Ongeldige lijst ID in QR-code. Controleer of de QR-code correct is."};const r=[/javascript:/i,/data:/i,/vbscript:/i,/file:/i,/\\.exe$/i,/\\.bat$/i,/\\.sh$/i];for(const e of r)if(e.test(s))return{valid:!1,error:"Potentieel onveilige QR-code geblokkeerd"};return{valid:!0,listId:t}}catch(t){return{valid:!1,error:`Fout bij verwerken van QR-code: ${t.message}`}}})(e);if(!r.valid)return l(r.error),{success:!1,error:r.error};const{listId:a}=r,i=await _t.withRetry(()=>ue(a),{operation:"get_shared_list",context:{listId:a},maxRetries:2});if(i&&i.permissionDenied){const e=ie();if(t.some(e=>e.id===a))return c("Je hebt al toegang tot deze lijst"),{success:!0,message:"Already has access"};try{return await _t.withRetry(()=>de(a,e),{operation:"qr_share_list",context:{listId:a,currentUserId:e},maxRetries:2}),o("Lijst succesvol gedeeld! 🎉"),c("De lijst verschijnt nu in je overzicht",3e3),{success:!0,listId:a}}catch(s){const t=_t.getUserMessage(s,"qr_share_list");return l(t),_t.logError(s,"qr_share_list",{listId:a,currentUserId:e}),{success:!1,error:t}}}if(!i){const e="Gedeelde lijst niet gevonden of niet toegankelijk";return l(e),{success:!1,error:e}}const n=ie();return t.some(e=>e.id===a)?(c(`Je hebt al toegang tot lijst "${i.name}"`),{success:!0,message:"Already has access"}):(await _t.withRetry(()=>de(a,n),{operation:"qr_share_list",context:{listId:a,currentUserId:n},maxRetries:2}),o(`Lijst "${i.name}" is gedeeld met jou! 🎉`),c("De lijst verschijnt nu in je overzicht",3e3),{success:!0,listId:a,listName:i.name})}catch(r){const t=_t.getUserMessage(r,"qr_scan");return l(t),_t.logError(r,"qr_scan",{scannedData:e}),{success:!1,error:t}}finally{n(!1)}},[t,l,o,c]),setIsProcessingQRScan:n}})(P,r),{showShare:Q,showScanner:Z,showUserManagement:Y,showUserNameModal:X,showDeleteConfirmation:ee,shareListId:te,managementListId:re,listToDelete:le,openShareModal:ge,closeShareModal:xe,openScannerModal:fe,closeScannerModal:ve,openUserManagementModal:we,closeUserManagementModal:je,closeUserNameModal:Se,openDeleteConfirmation:Ie,closeDeleteConfirmation:ke}=(()=>{const[t,s]=e.useState(!1),[r,a]=e.useState(!1),[i,n]=e.useState(!1),[o,l]=e.useState(!1),[c,d]=e.useState(!1),[m,u]=e.useState(null),[h,g]=e.useState(null),[p,b]=e.useState(null),x=e.useCallback(e=>{u(e),s(!0)},[]),y=e.useCallback(()=>{s(!1),u(null)},[]),f=e.useCallback(()=>{a(!0)},[]),v=e.useCallback(()=>{a(!1)},[]),w=e.useCallback(e=>{g(e),n(!0)},[]),j=e.useCallback(()=>{n(!1),g(null)},[]),S=e.useCallback(()=>{l(!0)},[]),I=e.useCallback(()=>{l(!1)},[]),k=e.useCallback(e=>{b(e),d(!0)},[]),N=e.useCallback(()=>{d(!1),b(null)},[]),C=e.useCallback(()=>{s(!1),a(!1),n(!1),l(!1),d(!1),u(null),g(null),b(null)},[]),_=e.useCallback(()=>t||r||i||o||c,[t,r,i,o,c]);return{showShare:t,showScanner:r,showUserManagement:i,showUserNameModal:o,showDeleteConfirmation:c,shareListId:m,managementListId:h,listToDelete:p,openShareModal:x,closeShareModal:y,openScannerModal:f,closeScannerModal:v,openUserManagementModal:w,closeUserManagementModal:j,openUserNameModal:S,closeUserNameModal:I,openDeleteConfirmation:k,closeDeleteConfirmation:N,closeAllModals:C,isAnyModalOpen:_,setShowShare:s,setShowScanner:a,setShowUserManagement:n,setShowUserNameModal:l,setShowDeleteConfirmation:d,setShareListId:u,setManagementListId:g,setListToDelete:b}})(),[Ne,Ce]=s.useState(!1),_e=()=>Ce(!0),Ee=()=>Ce(!1);e.useEffect(()=>()=>{},[]),e.useEffect(()=>{const e=setTimeout(()=>{Le(()=>ye(()=>import("./Settings-B3RWAeU_.js"),__vite__mapDeps([0,1,2,3]))),Le(()=>ye(()=>import("./QRScannerModal-CgzqOKzR.js"),__vite__mapDeps([11,1,2,3])))},2e3);return()=>clearTimeout(e)},[]);const Te=n,Re=o,De=l;e.useEffect(()=>{"undefined"!=typeof window&&(window.debugThemes=ts)},[]),e.useEffect(()=>{i||q()},[i,r,q]),e.useEffect(()=>{const e=()=>{U||z||V||F(P)};return window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)},[U,z,P,V,F]);const Ae=async()=>{if(De.trim()){p(De);try{const e=await $(De);e.success?b():x(e.error)}catch(e){x(e.message||"Failed to create list")}}},Oe=e=>e&&e.isCreator,Me=e=>{const t=P.find(t=>t.id===e);t&&Ie(t)},He=e=>{ge(e),O("Deel de QR-code of link om je lijst te delen! 📤")},We=e=>{we(e),O("Beheer gebruikers die toegang hebben tot je lijst 👥")};if(U)return t.jsx("div",{className:"min-h-screen-safe flex items-center justify-center bg-[rgb(var(--bg-color))] safe-area-all",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),t.jsx("p",{className:"text-[rgb(var(--text-color))]/80",children:"Verbinden met database..."})]})});if(z){const e=window.location.search.includes("test=true");if(!e)return t.jsx(Et,{message:"Er ging iets mis met de boodschappenlijst applicatie. Probeer het opnieuw of herlaad de pagina.",children:t.jsxs("div",{className:"min-h-screen-safe bg-[rgb(var(--bg-color))] transition-colors duration-300",children:[t.jsx("div",{className:"fixed inset-x-0 top-0 h-[var(--safe-area-inset-top)] bg-[rgb(var(--card-bg))] z-50"}),t.jsx("div",{className:"fixed inset-x-0 top-0 z-50 bg-[rgb(var(--card-bg))] border-b border-[rgb(var(--border-color))]/20 px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[t.jsx("div",{className:"flex items-center space-x-4",children:t.jsx("h1",{className:"text-lg font-bold text-[rgb(var(--card-text))]",children:"Boodschappenlijst"})}),t.jsx(Mr,{currentPage:Te,onNavigate:m,onToggleTheme:S,onOpenScanner:fe,onOpenPerformanceDashboard:_e,theme:v||"light",listsCount:P.length})]})}),t.jsx("main",{className:"w-full max-w-[1920px] mx-auto px-3 sm:px-4 lg:px-8 xl:px-12 py-4 sm:py-6 lg:py-8 xl:py-12 safe-area-x content-safe-area overflow-x-hidden",style:{paddingTop:"calc(var(--header-height) + 1rem)"},children:t.jsx(nt,{error:z,onRetry:B})}),Ne&&t.jsx(pt,{onClose:Ee})]})});e&&P.length}const Ge=!se;return t.jsx(Et,{message:"Er ging iets mis met de boodschappenlijst applicatie. Probeer het opnieuw of herlaad de pagina.",children:t.jsxs("div",{className:"min-h-screen-safe bg-[rgb(var(--bg-color))] transition-colors duration-300",children:[t.jsx("div",{className:"fixed inset-x-0 top-0 h-[var(--safe-area-inset-top)] bg-[rgb(var(--card-bg))] z-50"}),t.jsx(Mr,{currentPage:Te,onNavigate:m,onToggleTheme:S,onOpenScanner:fe,onOpenPerformanceDashboard:_e,theme:v,listsCount:P.length}),t.jsx("main",{className:"w-full max-w-[1920px] mx-auto px-3 sm:px-4 lg:px-8 xl:px-12 py-4 sm:py-6 lg:py-8 xl:py-12 safe-area-x content-safe-area overflow-x-hidden",style:{paddingTop:"calc(var(--header-height) + 1rem)"},children:"settings"===Te?t.jsx(Pe,{lists:P,onBack:()=>m("overview"),onNavigateToAnalytics:()=>m("analytics"),onNavigateToTheme:()=>m("theme"),onNavigateToPersistence:()=>m("persistence")}):"analytics"===Te?t.jsx(Ue,{lists:P,onBack:()=>m("overview")}):"theme"===Te?t.jsx(ze,{onBack:()=>m("overview")}):"persistence"===Te?t.jsx(qe,{onBack:()=>m("overview")}):"list"===Te&&Re?t.jsx(Be,{list:Re,onBack:()=>m("overview"),onListUpdate:e=>{u(e)}}):t.jsxs("div",{className:"w-full md:flex md:space-x-6 lg:space-x-8 xl:space-x-12",children:[t.jsxs("div",{className:"w-full flex-1 min-w-0 md:min-w-[400px]",children:[t.jsxs(H.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-[rgb(var(--card-bg))] rounded-xl sm:rounded-2xl shadow-lg border border-[rgb(var(--border-color))]/20 p-4 sm:p-6 lg:p-8 xl:p-10 mb-6 sm:mb-8",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 sm:mb-6 lg:mb-8",children:[t.jsxs("div",{className:"mb-4 sm:mb-0 min-w-0 flex-1",children:[t.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl xl:text-3xl font-bold text-[rgb(var(--card-text))] mb-1 sm:mb-2 ipad-simple-fix",children:"Nieuwe lijst maken"}),t.jsx("p",{className:"text-[rgb(var(--text-color))]/60 text-sm lg:text-base ipad-simple-fix",children:"Maak een nieuwe boodschappenlijst en deel deze met anderen"})]}),t.jsxs("div",{className:"hidden lg:flex items-center space-x-4 text-sm text-[rgb(var(--text-color))]/60",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),t.jsxs("span",{children:[P.filter(e=>e.isCreator).length," eigenaar"]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-secondary rounded-full"}),t.jsxs("span",{children:[P.filter(e=>!e.isCreator).length," gedeeld"]})]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 lg:space-x-4 xl:space-x-6",children:[t.jsxs("div",{className:"flex-1 relative group",children:[t.jsx("input",{type:"text",value:De,onChange:e=>g(e.target.value),onKeyDown:e=>"Enter"===e.key&&Ae(),placeholder:"Naam van je boodschappenlijst...",className:"w-full px-3 sm:px-4 lg:px-6 py-3 lg:py-4 border-2 border-[rgb(var(--border-color))]/30 rounded-lg sm:rounded-xl lg:rounded-2xl focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary/50 bg-[rgb(var(--card-bg))] text-[rgb(var(--card-text))] text-sm sm:text-base lg:text-lg placeholder:text-[rgb(var(--text-color))]/40 transition-all duration-200 group-hover:border-[rgb(var(--border-color))]/50 touch-manipulation"}),t.jsx("div",{className:"absolute inset-0 rounded-lg sm:rounded-xl lg:rounded-2xl bg-[rgb(var(--primary-color))]/5 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none"})]}),t.jsxs("button",{onClick:Ae,disabled:!c||d,className:"flex items-center justify-center px-4 sm:px-6 lg:px-8 xl:px-10 py-3 lg:py-4 bg-[rgb(var(--color-primary-button))] hover:opacity-90 text-white rounded-lg sm:rounded-xl lg:rounded-2xl shadow-lg hover:shadow-xl transform active:scale-95 sm:hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:hover:shadow-lg transition-all duration-200 font-semibold text-sm sm:text-base lg:text-lg whitespace-nowrap touch-manipulation",children:[t.jsx(C,{className:"w-4 h-4 sm:w-5 sm:h-5 lg:w-6 lg:h-6 mr-2 lg:mr-3"}),t.jsx("span",{children:d?"Bezig...":"Lijst Aanmaken"})]})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2 gap-4 md:gap-6 lg:gap-4 xl:gap-6",children:P.map(e=>t.jsx(Or,{list:e,onOpen:h,onShare:He,onUserManagement:We,onDelete:Me,canDelete:Oe(e)},e.id))}),0===P.length&&t.jsx(H.div,{initial:{opacity:0},animate:{opacity:1},className:"col-span-full",children:t.jsx("div",{className:"bg-[rgb(var(--card-bg))] rounded-2xl shadow-lg border border-[rgb(var(--border-color))]/20 p-12 lg:p-16 xl:p-20 text-center",children:t.jsxs("div",{className:"max-w-md mx-auto",children:[t.jsx("div",{className:"w-20 h-20 lg:w-24 lg:h-24 bg-gradient-to-br from-primary/20 to-secondary/20 rounded-full flex items-center justify-center mx-auto mb-6 lg:mb-8",children:t.jsx(w,{className:"w-10 h-10 lg:w-12 lg:h-12 text-primary"})}),t.jsx("h3",{className:"text-xl lg:text-2xl xl:text-3xl font-bold text-[rgb(var(--card-text))] mb-4 lg:mb-6 ipad-simple-fix",children:"Welkom bij Boodschappenlijst!"}),t.jsx("p",{className:"text-[rgb(var(--text-color))]/60 mb-8 lg:mb-10 text-base lg:text-lg leading-relaxed ipad-simple-fix",children:"Je hebt nog geen lijsten. Begin door een nieuwe lijst aan te maken of scan een gedeelde lijst van iemand anders."}),t.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 lg:gap-6 justify-center items-center",children:[t.jsxs("button",{onClick:()=>fe(),className:"flex items-center justify-center px-6 lg:px-8 py-3 lg:py-4 bg-[rgb(var(--color-secondary-button))] hover:opacity-90 text-white rounded-xl lg:rounded-2xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 font-semibold text-base lg:text-lg",children:[t.jsx(N,{className:"w-5 h-5 lg:w-6 lg:h-6 mr-3"}),t.jsx("span",{children:"Scan Gedeelde Lijst"})]}),t.jsxs("div",{className:"flex items-center space-x-4 text-[rgb(var(--text-color))]/40",children:[t.jsx("div",{className:"w-12 h-px bg-[rgb(var(--border-color))]/30"}),t.jsx("span",{className:"text-sm lg:text-base font-medium",children:"of"}),t.jsx("div",{className:"w-12 h-px bg-[rgb(var(--border-color))]/30"})]}),t.jsx("p",{className:"text-[rgb(var(--text-color))]/60 text-sm lg:text-base ipad-simple-fix",children:"Maak hierboven een nieuwe lijst aan"})]})]})})})]}),t.jsx("div",{className:"hidden md:block md:w-72 lg:w-80 xl:w-96 flex-shrink-0",children:t.jsxs("div",{className:"sticky top-8 space-y-4 md:space-y-6",children:[t.jsxs(H.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-[rgb(var(--card-bg))] rounded-xl md:rounded-2xl shadow-lg border border-[rgb(var(--border-color))]/20 p-4 md:p-6",children:[t.jsxs("h3",{className:"text-base md:text-lg font-bold text-[rgb(var(--card-text))] mb-3 md:mb-4 flex items-center ipad-simple-fix",children:[t.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mr-3"}),"Overzicht"]}),t.jsxs("div",{className:"space-y-3 md:space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-[rgb(var(--text-color))]/70 text-xs md:text-sm",children:"Totaal lijsten"}),t.jsx("span",{className:"font-semibold text-[rgb(var(--card-text))] text-sm md:text-base",children:P.length})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-[rgb(var(--text-color))]/70 text-xs md:text-sm",children:"Eigenaar van"}),t.jsx("span",{className:"font-semibold text-primary text-sm md:text-base",children:P.filter(e=>e.isCreator).length})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-[rgb(var(--text-color))]/70 text-xs md:text-sm",children:"Gedeeld met jou"}),t.jsx("span",{className:"font-semibold text-secondary text-sm md:text-base",children:P.filter(e=>!e.isCreator).length})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-[rgb(var(--text-color))]/70 text-xs md:text-sm",children:"Totaal items"}),t.jsx("span",{className:"font-semibold text-accent text-sm md:text-base",children:P.reduce((e,t)=>e+(t.items||[]).length,0)})]})]})]}),t.jsxs(H.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1},className:"bg-[rgb(var(--card-bg))] rounded-xl md:rounded-2xl shadow-lg border border-[rgb(var(--border-color))]/20 p-4 md:p-6",children:[t.jsxs("h3",{className:"text-base md:text-lg font-bold text-[rgb(var(--card-text))] mb-3 md:mb-4 flex items-center ipad-simple-fix",children:[t.jsx("div",{className:"w-2 h-2 bg-secondary rounded-full mr-3"}),"Snelle acties"]}),t.jsxs("div",{className:"space-y-2 md:space-y-3",children:[t.jsxs("button",{onClick:()=>fe(),className:"w-full flex items-center px-3 md:px-4 py-2 md:py-3 bg-[rgb(var(--color-secondary-button))] hover:opacity-90 text-white rounded-lg md:rounded-xl shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200",children:[t.jsx(N,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 md:mr-3"}),t.jsx("span",{className:"font-medium text-sm md:text-base",children:"QR Scanner"})]}),t.jsxs("button",{onClick:()=>m("settings"),className:"w-full flex items-center px-3 md:px-4 py-2 md:py-3 bg-[rgb(var(--border-color))]/20 hover:bg-[rgb(var(--border-color))]/30 text-[rgb(var(--card-text))] rounded-lg md:rounded-xl transition-all duration-200",children:[t.jsx(j,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 md:mr-3"}),t.jsx("span",{className:"font-medium text-sm md:text-base",children:"Instellingen & Analytics"})]})]})]}),t.jsxs(H.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.15},className:"bg-[rgb(var(--card-bg))] rounded-xl md:rounded-2xl shadow-lg border border-[rgb(var(--border-color))]/20 p-4 md:p-6",children:[t.jsxs("h3",{className:"text-base md:text-lg font-bold text-[rgb(var(--card-text))] mb-3 md:mb-4 flex items-center ipad-simple-fix",children:[t.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full mr-3"}),"Thema Instellingen"]}),t.jsxs("div",{className:"space-y-2 md:space-y-3",children:[t.jsx("p",{className:"text-xs md:text-sm text-[rgb(var(--text-color))]/60 ipad-simple-fix",children:"Pas het uiterlijk van de app aan naar jouw voorkeur"}),t.jsx("button",{onClick:()=>m("theme"),className:"w-full flex items-center px-3 md:px-4 py-2 md:py-3 bg-[rgb(var(--color-accent-button))] hover:opacity-90 text-white rounded-lg md:rounded-xl shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200",children:t.jsx("span",{className:"font-medium text-sm md:text-base",children:"Thema Aanpassen"})})]})]}),t.jsxs(H.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-[rgb(var(--card-bg))] rounded-xl md:rounded-2xl shadow-lg border border-[rgb(var(--border-color))]/20 p-4 md:p-6",children:[t.jsxs("h3",{className:"text-base md:text-lg font-bold text-[rgb(var(--card-text))] mb-3 md:mb-4 flex items-center ipad-simple-fix",children:[t.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),"Data & Backup"]}),t.jsxs("div",{className:"space-y-2 md:space-y-3",children:[t.jsx("p",{className:"text-xs md:text-sm text-[rgb(var(--text-color))]/60 ipad-simple-fix",children:"Beheer je data en maak back-ups"}),t.jsx("button",{onClick:()=>m("persistence"),className:"w-full flex items-center px-3 md:px-4 py-2 md:py-3 bg-[rgb(var(--color-info-button))] hover:opacity-90 text-white rounded-lg md:rounded-xl shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200",children:t.jsx("span",{className:"font-medium text-sm md:text-base",children:"Data Beheren"})})]})]}),P.length>0&&t.jsxs(H.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-[rgb(var(--card-bg))] rounded-xl md:rounded-2xl shadow-lg border border-[rgb(var(--border-color))]/20 p-4 md:p-6",children:[t.jsxs("h3",{className:"text-base md:text-lg font-bold text-[rgb(var(--card-text))] mb-3 md:mb-4 flex items-center ipad-simple-fix",children:[t.jsx("div",{className:"w-2 h-2 bg-accent rounded-full mr-3"}),"Recente activiteit"]}),t.jsxs("div",{className:"space-y-2 md:space-y-3",children:[P.filter(e=>e.updatedAt).sort((e,t)=>{const s=e.updatedAt.toDate?e.updatedAt.toDate():new Date(e.updatedAt);return(t.updatedAt.toDate?t.updatedAt.toDate():new Date(t.updatedAt))-s}).slice(0,3).map((e,s)=>t.jsxs("div",{className:"flex items-center space-x-2 md:space-x-3 p-2 md:p-3 rounded-lg md:rounded-xl bg-[rgb(var(--border-color))]/10 hover:bg-[rgb(var(--border-color))]/20 transition-colors cursor-pointer",onClick:()=>h(e),children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium text-[rgb(var(--card-text))] break-words text-xs md:text-sm ipad-simple-fix",children:e.name}),t.jsxs("p",{className:"text-xs text-[rgb(var(--text-color))]/60 ipad-simple-fix",children:[e.items?.length||0," items • ",e.isCreator?"Eigenaar":"Gedeeld"]})]})]},e.id)),0===P.filter(e=>e.updatedAt).length&&t.jsx("p",{className:"text-xs md:text-sm text-[rgb(var(--text-color))]/60 text-center py-3 md:py-4 ipad-simple-fix",children:"Geen recente activiteit"})]})]})]})})]})}),Ge&&t.jsxs("div",{className:"fixed bottom-20 right-4 bg-[rgb(var(--warning-color))] text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2 mobile-touch-safe mr-safe",children:[t.jsx(_,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Offline mode"})]}),Q&&t.jsx(Fe,{listId:te,list:P.find(e=>e.id===te),onClose:xe}),Z&&t.jsx(Ve,{onClose:ve,onScanSuccess:async e=>{await J(e)}}),Y&&t.jsx($e,{list:P.find(e=>e.id===re),onClose:je,onListUpdate:e=>{}}),X&&t.jsx(at,{onNameSet:async e=>{Se();try{await _t.withRetry(()=>a(e),{operation:"set_user_name",context:{name:e}}),await q(),D(`Welkom ${e}! Je kunt nu lijsten maken en delen. 🎉`)}catch(t){const s=_t.getUserMessage(t,"set_user_name");A(s),_t.logError(t,"set_user_name",{name:e})}}}),ee&&le&&t.jsx(it,{isOpen:ee,onClose:ke,onConfirm:async()=>{if(le){y(le.id);try{const e=await W(le.id);e.success?ke():(f(le.id),A(e.error||"Failed to delete list"))}catch(e){f(le.id),A(e.message||"Failed to delete list")}}},title:"Lijst verwijderen",message:`Weet je zeker dat je de lijst "${le.name}" wilt verwijderen? Deze actie kan niet ongedaan worden gemaakt.`,confirmText:"Verwijderen",cancelText:"Annuleren",type:"danger"}),t.jsx(ut,{toasts:T,removeToast:L}),t.jsx(gt,{}),Ne&&t.jsx(pt,{onClose:Ee})]})})}Mr.propTypes={currentPage:r.string,onNavigate:et.isRequired,onToggleTheme:et.isRequired,onOpenScanner:et.isRequired,onOpenPerformanceDashboard:r.func,theme:rt(["light","dark"]).isRequired,listsCount:r.number.isRequired},E.createRoot(document.getElementById("root")).render(t.jsx(s.StrictMode,{children:t.jsx(es,{children:t.jsx(J,{children:t.jsx(Z,{children:t.jsx(Pr,{})})})})}));export{st as C,et as E,Xt as a,Wt as b,Ht as c,ge as d,he as e,ue as f,ie as g,le as h,ee as i,ht as p,me as r,We as s,K as u};

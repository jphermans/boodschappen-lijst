@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* SafeArea environment variables for mobile devices */
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);
  
  /* Additional safe area variables for flexible usage */
  --safe-area-top: max(env(safe-area-inset-top), 20px); /* Minimum 20px for status bar */
  --safe-area-bottom: max(env(safe-area-inset-bottom), 0px);
  --safe-area-left: env(safe-area-inset-left);
  --safe-area-right: env(safe-area-inset-right);
  
  /* Header height accounting for safe area */
  --header-height: calc(64px + var(--safe-area-inset-top));
  --header-height-lg: calc(80px + var(--safe-area-inset-top));
  
  /* Content padding with safe areas */
  --content-padding-top: var(--safe-area-inset-top);
  --content-padding-bottom: var(--safe-area-inset-bottom);
  --content-padding-left: var(--safe-area-inset-left);
  --content-padding-right: var(--safe-area-inset-right);
  
  /* Default Gruvbox Light Theme - Fallback values */
  --color-primary: 175 58 3; /* Gruvbox orange #af3a03 */
  --color-secondary: 121 116 14; /* Gruvbox green #79740e */
  --color-accent: 157 0 6; /* Gruvbox red #9d0006 */
  --color-background: 251 241 199; /* Gruvbox light background #fbf1c7 */
  --color-surface: 242 229 188; /* Gruvbox light1 #f2e5bc */
  --color-text: 60 56 54; /* Gruvbox dark foreground #3c3836 */
  --color-textSecondary: 102 92 84; /* Gruvbox gray #665c54 */
  --color-success: 121 116 14; /* Gruvbox green #79740e */
  --color-warning: 215 153 33; /* Gruvbox yellow #d79921 */
  --color-error: 157 0 6; /* Gruvbox red #9d0006 */
  --color-info: 69 133 136; /* Gruvbox blue #458588 */
  
  /* Button-specific colors for better contrast */
  --color-primary-button: 175 58 3; /* Darker orange for buttons */
  --color-secondary-button: 121 116 14; /* Darker green for buttons */
  --color-accent-button: 204 36 29; /* Brighter red for buttons #cc241d */
  --color-info-button: 69 133 136; /* Blue for info buttons */
  --color-error-button: 204 36 29; /* Brighter red for error buttons #cc241d */
  --color-warning-button: 181 118 20; /* Darker yellow for buttons #b57614 */
  
  /* Legacy support */
  --bg-color: var(--color-background);
  --text-color: var(--color-text);
  --border-color: 213 196 161; /* Gruvbox light2 #d5c4a1 */
  --card-bg: var(--color-surface);
  --card-text: var(--color-text);
  
  /* Hex values for direct use */
  --color-primary-hex: #af3a03;
  --color-secondary-hex: #79740e;
  --color-accent-hex: #9d0006;
  --color-background-hex: #fbf1c7;
  --color-surface-hex: #f2e5bc;
  --color-text-hex: #3c3836;
  --color-textSecondary-hex: #665c54;
  --color-success-hex: #79740e;
  --color-warning-hex: #d79921;
  --color-error-hex: #9d0006;
  --color-info-hex: #458588;
}

[data-theme="dark"] {
  /* Default Gruvbox Dark Theme - Fallback values */
  --color-primary: 254 128 25; /* Gruvbox orange #fe8019 */
  --color-secondary: 184 187 38; /* Gruvbox green #b8bb26 */
  --color-accent: 251 73 52; /* Gruvbox red #fb4934 */
  --color-background: 40 40 40; /* Gruvbox dark background #282828 */
  --color-surface: 60 56 54; /* Gruvbox dark1 #3c3836 */
  --color-text: 235 219 178; /* Gruvbox light foreground #ebdbb2 */
  --color-textSecondary: 168 153 132; /* Gruvbox light2 #a89984 */
  --color-success: 184 187 38; /* Gruvbox green #b8bb26 */
  --color-warning: 250 189 47; /* Gruvbox yellow #fabd2f */
  --color-error: 251 73 52; /* Gruvbox red #fb4934 */
  --color-info: 131 165 152; /* Gruvbox blue #83a598 */
  
  /* Button-specific colors for better contrast */
  --color-primary-button: 254 128 25; /* Bright orange for buttons */
  --color-secondary-button: 184 187 38; /* Bright green for buttons */
  --color-accent-button: 251 73 52; /* Bright red for buttons */
  --color-info-button: 131 165 152; /* Blue for info buttons */
  --color-error-button: 251 73 52; /* Bright red for error buttons */
  --color-warning-button: 250 189 47; /* Bright yellow for buttons */
  
  /* Legacy support */
  --bg-color: var(--color-background);
  --text-color: var(--color-text);
  --border-color: 80 73 69; /* Gruvbox dark gray #504945 */
  --card-bg: var(--color-surface);
  --card-text: var(--color-text);
  
  /* Hex values for direct use */
  --color-primary-hex: #fe8019;
  --color-secondary-hex: #b8bb26;
  --color-accent-hex: #fb4934;
  --color-background-hex: #282828;
  --color-surface-hex: #3c3836;
  --color-text-hex: #ebdbb2;
  --color-textSecondary-hex: #a89984;
  --color-success-hex: #b8bb26;
  --color-warning-hex: #fabd2f;
  --color-error-hex: #fb4934;
  --color-info-hex: #83a598;
}

/* Dynamic theme support - these will be overridden by the unified theme system */
.theme-dynamic {
  /* Colors will be dynamically set by JavaScript */
}

/* Base styles */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: rgb(var(--color-background));
  color: rgb(var(--color-text));
  transition: background-color 0.3s ease, color 0.3s ease;
  
  /* SafeArea support - extend background to edges */
  padding: var(--safe-area-inset-top) var(--safe-area-inset-right) var(--safe-area-inset-bottom) var(--safe-area-inset-left);
  
  /* Ensure full viewport coverage on mobile */
  min-height: 100vh;
  min-height: 100dvh; /* Dynamic viewport height for mobile browsers */
}

#root {
  min-height: calc(100vh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
  min-height: calc(100dvh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
  background-color: rgb(var(--color-background));
  color: rgb(var(--color-text));
  
  /* Remove body padding from content area */
  margin: calc(-1 * var(--safe-area-inset-top)) calc(-1 * var(--safe-area-inset-right)) calc(-1 * var(--safe-area-inset-bottom)) calc(-1 * var(--safe-area-inset-left));
  padding: 0;
}

/* Unified theme color utilities */
.text-primary {
  color: rgb(var(--color-primary));
}

.text-secondary {
  color: rgb(var(--color-secondary));
}

.text-accent {
  color: rgb(var(--color-accent));
}

.text-success {
  color: rgb(var(--color-success));
}

.text-warning {
  color: rgb(var(--color-warning));
}

.text-error {
  color: rgb(var(--color-error));
}

.text-info {
  color: rgb(var(--color-info));
}

.bg-primary {
  background-color: rgb(var(--color-primary));
}

.bg-secondary {
  background-color: rgb(var(--color-secondary));
}

.bg-accent {
  background-color: rgb(var(--color-accent));
}

.bg-success {
  background-color: rgb(var(--color-success));
}

/* Progress bar specific styles for better visibility */
.progress-bar-fill {
  background-color: rgb(var(--color-success));
  height: 100%;
  border-radius: inherit;
  transition: width 0.5s ease-out;
  min-width: 0;
}

.progress-bar-container {
  background-color: rgba(var(--border-color), 0.2);
  border-radius: 9999px;
  overflow: hidden;
  position: relative;
  width: 100%;
}

/* Fallback colors for better browser compatibility */
:root {
  --progress-bg-light: rgba(213, 196, 161, 0.2);
  --progress-fill-light: #79740e;
}

[data-theme="dark"] {
  --progress-bg-dark: rgba(80, 73, 69, 0.2);
  --progress-fill-dark: #b8bb26;
}

.progress-bar-container {
  background-color: var(--progress-bg-light);
}

[data-theme="dark"] .progress-bar-container {
  background-color: var(--progress-bg-dark);
}

.progress-bar-fill {
  background-color: var(--progress-fill-light);
}

[data-theme="dark"] .progress-bar-fill {
  background-color: var(--progress-fill-dark);
}

.bg-warning {
  background-color: rgb(var(--color-warning));
}

.bg-error {
  background-color: rgb(var(--color-error));
}

.bg-info {
  background-color: rgb(var(--color-info));
}

.bg-surface {
  background-color: rgb(var(--color-surface));
}

.bg-background {
  background-color: rgb(var(--color-background));
}

/* Button-specific background utilities for better contrast */
.bg-primary-button {
  background-color: rgb(var(--color-primary-button));
}

.bg-secondary-button {
  background-color: rgb(var(--color-secondary-button));
}

.bg-accent-button {
  background-color: rgb(var(--color-accent-button));
}

.bg-info-button {
  background-color: rgb(var(--color-info-button));
}

.bg-error-button {
  background-color: rgb(var(--color-error-button));
}

.bg-warning-button {
  background-color: rgb(var(--color-warning-button));
}

/* Border utilities */
.border-primary {
  border-color: rgb(var(--color-primary));
}

.border-secondary {
  border-color: rgb(var(--color-secondary));
}

.border-accent {
  border-color: rgb(var(--color-accent));
}

.border-surface {
  border-color: rgb(var(--color-surface));
}

/* Gradient utilities using theme colors */
.bg-gradient-primary {
  background: linear-gradient(135deg, rgb(var(--color-primary)), rgb(var(--color-secondary)));
}

.bg-gradient-accent {
  background: linear-gradient(135deg, rgb(var(--color-accent)), rgb(var(--color-primary)));
}

.bg-gradient-surface {
  background: linear-gradient(135deg, rgb(var(--color-surface)), rgb(var(--color-background)));
}

/* Theme transition animations */
.theme-transition {
  transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
}

/* Accessibility helpers */
.high-contrast {
  filter: contrast(1.2);
}

.reduced-motion {
  transition: none !important;
  animation: none !important;
}

/* Color picker specific styles */
.color-picker-swatch {
  width: 2rem;
  height: 2rem;
  border-radius: 0.5rem;
  border: 2px solid rgb(var(--color-text) / 0.2);
  cursor: pointer;
  transition: all 0.2s ease;
}

.color-picker-swatch:hover {
  transform: scale(1.1);
  border-color: rgb(var(--color-primary));
}

.color-picker-swatch.active {
  border-color: rgb(var(--color-primary));
  box-shadow: 0 0 0 2px rgb(var(--color-primary) / 0.3);
}

/* Theme preview styles */
.theme-preview {
  border: 1px solid rgb(var(--color-text) / 0.2);
  border-radius: 0.75rem;
  overflow: hidden;
  transition: all 0.2s ease;
}

.theme-preview:hover {
  border-color: rgb(var(--color-primary));
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgb(var(--color-text) / 0.1);
}

.theme-preview.active {
  border-color: rgb(var(--color-primary));
  box-shadow: 0 0 0 2px rgb(var(--color-primary) / 0.3);
}

/* Responsive design helpers */
@media (prefers-reduced-motion: reduce) {
  .theme-transition {
    transition: none;
  }
}

@media (prefers-contrast: high) {
  :root {
    --color-text: 0 0 0;
    --color-background: 255 255 255;
  }
  
  [data-theme="dark"] {
    --color-text: 255 255 255;
    --color-background: 0 0 0;
  }
}

/* SafeArea utility classes */
.safe-area-top {
  padding-top: var(--safe-area-inset-top);
}

.safe-area-bottom {
  padding-bottom: var(--safe-area-inset-bottom);
}

.safe-area-left {
  padding-left: var(--safe-area-inset-left);
}

.safe-area-right {
  padding-right: var(--safe-area-inset-right);
}

.safe-area-x {
  padding-left: var(--safe-area-inset-left);
  padding-right: var(--safe-area-inset-right);
}

.safe-area-y {
  padding-top: var(--safe-area-inset-top);
  padding-bottom: var(--safe-area-inset-bottom);
}

.safe-area-all {
  padding: var(--safe-area-inset-top) var(--safe-area-inset-right) var(--safe-area-inset-bottom) var(--safe-area-inset-left);
}

/* Header-specific SafeArea classes */
.header-safe-area {
  padding-top: var(--safe-area-top);
  min-height: var(--header-height);
}

.header-safe-area-lg {
  padding-top: var(--safe-area-top);
  min-height: var(--header-height-lg);
}

/* Content area with safe spacing */
.content-safe-area {
  padding-top: var(--content-padding-top);
  padding-bottom: var(--content-padding-bottom);
  padding-left: var(--content-padding-left);
  padding-right: var(--content-padding-right);
}

/* Fixed positioning with SafeArea support */
.fixed-top-safe {
  position: fixed;
  top: var(--safe-area-inset-top);
  left: var(--safe-area-inset-left);
  right: var(--safe-area-inset-right);
  z-index: 1000;
}

.fixed-bottom-safe {
  position: fixed;
  bottom: var(--safe-area-inset-bottom);
  left: var(--safe-area-inset-left);
  right: var(--safe-area-inset-right);
  z-index: 1000;
}

/* Margin utilities for SafeArea */
.mt-safe {
  margin-top: var(--safe-area-inset-top);
}

.mb-safe {
  margin-bottom: var(--safe-area-inset-bottom);
}

.ml-safe {
  margin-left: var(--safe-area-inset-left);
}

.mr-safe {
  margin-right: var(--safe-area-inset-right);
}

/* Full viewport height accounting for safe areas */
.min-h-screen-safe {
  min-height: calc(100vh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
  min-height: calc(100dvh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
}

.h-screen-safe {
  height: calc(100vh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
  height: calc(100dvh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
}

/* Mobile-specific optimizations */
@media (max-width: 768px) {
  /* Ensure touch targets are accessible on mobile */
  .mobile-touch-safe {
    padding-bottom: max(var(--safe-area-inset-bottom), 16px);
  }
  
  /* Floating action buttons with safe area */
  .fab-safe {
    bottom: calc(var(--safe-area-inset-bottom) + 1rem);
    right: calc(var(--safe-area-inset-right) + 1rem);
  }
  
  /* Modal positioning with safe areas */
  .modal-safe {
    padding: var(--safe-area-inset-top) var(--safe-area-inset-right) var(--safe-area-inset-bottom) var(--safe-area-inset-left);
  }
}

/* Landscape orientation adjustments */
@media (orientation: landscape) and (max-height: 500px) {
  /* Reduce header height in landscape on small screens */
  .header-safe-area {
    min-height: calc(48px + var(--safe-area-inset-top));
  }
  
  .header-safe-area-lg {
    min-height: calc(56px + var(--safe-area-inset-top));
  }
}

/* Universal iPad text fixes - Aggressive approach that works across all Safari/WebKit versions */

/* Apply to ALL iPad-related classes regardless of media queries */
.ipad-text-fix,
.ipad-title-fix,
.ipad-horizontal-text,
.ipad-heading-fix,
.ipad-subtitle-fix,
.ipad-force-horizontal,
.ipad-pro-text-fix {
  writing-mode: horizontal-tb !important;
  -webkit-writing-mode: horizontal-tb !important;
  -ms-writing-mode: lr-tb !important;
  text-orientation: mixed !important;
  -webkit-text-orientation: mixed !important;
  direction: ltr !important;
  unicode-bidi: normal !important;
  word-break: normal !important;
  overflow-wrap: break-word !important;
  hyphens: none !important;
  -webkit-hyphens: none !important;
  white-space: normal !important;
  line-height: 1.3 !important;
  display: block !important;
  width: 100% !important;
  max-width: 100% !important;
  text-align: left !important;
  font-synthesis: none !important;
  -webkit-font-feature-settings: normal !important;
  font-feature-settings: normal !important;
  text-rendering: optimizeLegibility !important;
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
}

/* Flex container fixes */
.ipad-flex-fix {
  flex-wrap: wrap !important;
  min-width: 0 !important;
  width: 100% !important;
  display: flex !important;
  flex-direction: column !important;
}

/* iPad-specific media queries with more aggressive targeting */
@media screen and (min-width: 768px) and (max-width: 1366px) {
  /* Target ALL text elements on iPad screens */
  * {
    writing-mode: horizontal-tb !important;
    -webkit-writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    -webkit-text-orientation: mixed !important;
    direction: ltr !important;
  }
  
  /* Specific targeting for headings and text elements */
  h1, h2, h3, h4, h5, h6, p, span, div, a, button, input, textarea, label {
    writing-mode: horizontal-tb !important;
    -webkit-writing-mode: horizontal-tb !important;
    -ms-writing-mode: lr-tb !important;
    text-orientation: mixed !important;
    -webkit-text-orientation: mixed !important;
    direction: ltr !important;
    unicode-bidi: normal !important;
  }
}

/* Safari-specific fixes for iPad */
@media screen and (-webkit-min-device-pixel-ratio: 1) and (min-width: 768px) and (max-width: 1366px) {
  .ipad-text-fix,
  .ipad-title-fix,
  .ipad-horizontal-text,
  .ipad-heading-fix,
  .ipad-subtitle-fix,
  .ipad-force-horizontal,
  .ipad-pro-text-fix {
    writing-mode: horizontal-tb !important;
    -webkit-writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    -webkit-text-orientation: mixed !important;
    direction: ltr !important;
  }
}

/* Touch device detection for iPad */
@media (pointer: coarse) and (min-width: 768px) {
  .ipad-text-fix,
  .ipad-title-fix,
  .ipad-horizontal-text,
  .ipad-heading-fix,
  .ipad-subtitle-fix,
  .ipad-force-horizontal,
  .ipad-pro-text-fix {
    writing-mode: horizontal-tb !important;
    -webkit-writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    -webkit-text-orientation: mixed !important;
    direction: ltr !important;
  }
}

/* Hover capability detection (iPad doesn't have hover) */
@media (hover: none) and (pointer: coarse) and (min-width: 768px) {
  * {
    writing-mode: horizontal-tb !important;
    -webkit-writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    -webkit-text-orientation: mixed !important;
    direction: ltr !important;
  }
}

/* iOS Safari specific targeting */
@supports (-webkit-touch-callout: none) {
  @media screen and (min-width: 768px) and (max-width: 1366px) {
    .ipad-text-fix,
    .ipad-title-fix,
    .ipad-horizontal-text,
    .ipad-heading-fix,
    .ipad-subtitle-fix,
    .ipad-force-horizontal,
    .ipad-pro-text-fix {
      writing-mode: horizontal-tb !important;
      -webkit-writing-mode: horizontal-tb !important;
      text-orientation: mixed !important;
      -webkit-text-orientation: mixed !important;
      direction: ltr !important;
    }
  }
}

/* Fallback for any remaining cases */
@media screen {
  .ipad-force-horizontal-always {
    writing-mode: horizontal-tb !important;
    -webkit-writing-mode: horizontal-tb !important;
    -ms-writing-mode: lr-tb !important;
    text-orientation: mixed !important;
    -webkit-text-orientation: mixed !important;
    direction: ltr !important;
    unicode-bidi: normal !important;
    display: block !important;
    width: 100% !important;
    text-align: left !important;
  }
}

/* Ultra-aggressive iPad title fix - highest specificity */
h1.ipad-force-horizontal-always,
.ipad-force-horizontal-always h1,
h1[class*="ipad-force-horizontal-always"] {
  writing-mode: horizontal-tb !important;
  -webkit-writing-mode: horizontal-tb !important;
  -ms-writing-mode: lr-tb !important;
  text-orientation: mixed !important;
  -webkit-text-orientation: mixed !important;
  direction: ltr !important;
  unicode-bidi: normal !important;
  display: block !important;
  width: 100% !important;
  text-align: left !important;
  font-style: normal !important;
  font-variant: normal !important;
  text-transform: none !important;
  line-height: 1.2 !important;
  letter-spacing: normal !important;
  word-spacing: normal !important;
  text-indent: 0 !important;
  text-shadow: none !important;
  text-decoration: none !important;
}

/* Target the specific title text content */
h1:contains("Boodschappenlijst"),
.ipad-heading-fix:contains("Boodschappenlijst") {
  writing-mode: horizontal-tb !important;
  -webkit-writing-mode: horizontal-tb !important;
  direction: ltr !important;
  text-orientation: mixed !important;
  -webkit-text-orientation: mixed !important;
}

/* Additional iPad targeting with higher specificity */
@media screen and (min-width: 768px) and (max-width: 1366px) {
  h1.ipad-force-horizontal-always,
  .ipad-force-horizontal-always h1,
  h1[class*="ipad"] {
    writing-mode: horizontal-tb !important;
    -webkit-writing-mode: horizontal-tb !important;
    -ms-writing-mode: lr-tb !important;
    text-orientation: mixed !important;
    -webkit-text-orientation: mixed !important;
    direction: ltr !important;
    unicode-bidi: normal !important;
    display: block !important;
    position: relative !important;
    transform: none !important;
    -webkit-transform: none !important;
  }
}